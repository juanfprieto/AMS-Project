oboutGrid=function(pd,md,Jc,Tc,bd,Jb,sd,td,ad,ab,fb,gd,fd,tb,Sc,id,Vc,Lc,Uc,Ic,Ib,ub,rd,t,r,y,s,B,S,h,n,g,l,i,f,w,A,v,z,x,u,b,m,d,o,c,p,e,k,j,C,q,Pb,lb,db,Z,hc,Hb,cb,yb,V,Kb,zb,Lb,Ab,dd,Gc,Eb,Db,ed,Sb,bc,vc,tc,kd,Mc,Ob,N,ic,Ec,uc,Zb,wc,ld,Ub,wb,mb,gb,Fc,Mb,ac,qb,Yb,ob,Tb,Nb,I,xb,W,H,U,M,pb,E,D,ib,T,nb,hb,qd,mc,kc,pc,Zc,Yc,Hc,Rc,Nc,yc,Bc,xc,Oc,qc,cc,Ac,zc,lc,oc,dc,bb,Y,kb,K,Gb,Fb,jc,sb,J,od,nd,Kc,Qc,cd,Wc,Cb,Bb,vb,Q,Wb,Vb,rc,Dc,F,P,jb,O,G,Xc,Rb,Qb,Cc,L,ec,jd,Xb,nc,eb,sc,rb,fc,R,a,gc,X,Pc,hd){this._core=Obout.Interface.OboutCore;this.ID=pd;this.UniqueID=md;this.CallbackMode=Jc;this.IsCallBack=Tc;this.Serialize=bd;this.AutoGenerateColumns=Jb;this.Version="7.0.9";this.AllowPageSizeSelection=tb;this.AllowPaging=Sc;this.PageSize=id;this.PageNumber=Vc;this.TotalRecords=Lc;this.ColsNumber=Uc;this.AllowSorting=Ic;this.AllowColumnResizing=Ib;this.AllowColumnReordering=ub;this.AllowFiltering=rc;this.FilterPosition=Dc;this.RemovableDOMObjects=[];this.RemovableEventHandlersForDOMObjects=[];this.FileName=jd;this.ElementsClientIds=null;this.ElementsClientIdsContainer=oboutUtils.getById("ob_"+this.ID+"_ElementsClientIdsContainer");this.RemovableDOMObjects.push(["ElementsClientIdsContainer",true]);this.getElementsClientIds();this.GridMainContainer=oboutUtils.getById(this.ElementsClientIds.MainContainerID);this.RemovableDOMObjects.push(["GridMainContainer",true]);this.GridHeadingContainer=oboutUtils.getById(this.ElementsClientIds.HeadingContainerID);this.RemovableDOMObjects.push(["GridHeadingContainer",true]);this.GridGroupingAreaContainer=oboutUtils.getById(this.ElementsClientIds.GroupingAreaContainerID);this.RemovableDOMObjects.push(["GridGroupingAreaContainer",true]);this.GridHeaderContainer=oboutUtils.getById(this.ElementsClientIds.HeaderContainerID);this.RemovableDOMObjects.push(["GridHeaderContainer",true]);this.GridBodyContainer=oboutUtils.getById(this.ElementsClientIds.BodyContainerID);this.RemovableDOMObjects.push(["GridBodyContainer",true]);this.LoadingMessageContainer=oboutUtils.getById(this.ElementsClientIds.LoadingMessageContainerID);this.RemovableDOMObjects.push(["LoadingMessageContainerID",true]);this.GridFooterContainer=oboutUtils.getById(this.ElementsClientIds.FooterContainerID);this.RemovableDOMObjects.push(["GridFooterContainer",true]);this.GridTopFooterContainer=oboutUtils.getById(this.ElementsClientIds.TopFooterContainerID);this.RemovableDOMObjects.push(["GridTopFooterContainer",true]);this.HorizontalScroller=oboutUtils.getById(this.ElementsClientIds.HorizontalScrollerID);this.RemovableDOMObjects.push(["HorizontalScroller",true]);this.SerializedColumnsContainer=oboutUtils.getById(this.ElementsClientIds.SerializedColumnsContainerID);this.RemovableDOMObjects.push(["SerializedColumnsContainer",true]);this.HeaderCornersContainer=oboutUtils.getById(this.ElementsClientIds.HeaderCornersContainerID);this.RemovableDOMObjects.push(["HeaderCornersContainerID",true]);this.FooterCornersContainer=oboutUtils.getById(this.ElementsClientIds.FooterCornersContainerID);this.RemovableDOMObjects.push(["FooterCornersContainerID",true]);this.IsCallbackContainer=oboutUtils.getById(this.ElementsClientIds);this.RemovableDOMObjects.push(["IsCallbackContainer",true]);this.ShowHeader=gd;this.ShowFooter=fd;this.PageSelector=oboutUtils.getById(this.ElementsClientIds.PageSelectorID);this.RemovableDOMObjects.push(["PageSelector",false]);try{if(this.ElementsClientIds.PageSizeSelectorID)this.PageSizeSelector=eval(this.ElementsClientIds.PageSizeSelectorID);if(this.ElementsClientIds.TopPageSizeSelectorID)this.TopPageSizeSelector=eval(this.ElementsClientIds.TopPageSizeSelectorID)}catch(ud){if(a){masterGrid=eval(a);if(masterGrid.PreventDetailGridInitialization)return}}this.PagingContainer=oboutUtils.getById(this.ElementsClientIds.PagingContainerID);this.RemovableDOMObjects.push(["PagingContainer",false]);this.SortExpressionHidden=oboutUtils.getById(this.ElementsClientIds.SortExpressionContainerID);this.RemovableDOMObjects.push(["SortExpressionHidden",true]);this.SortOrderHidden=oboutUtils.getById(this.ElementsClientIds.SortOrderContainerID);this.RemovableDOMObjects.push(["SortOrderHidden",true]);if(this.ElementsClientIds.ViewStateContainerID){this.ViewStateContainer=oboutUtils.getById(this.ElementsClientIds.ViewStateContainerID);this.RemovableDOMObjects.push(["ViewStateContainer",false])}this.CommandVariableSeparator=t;this.CommandNameValueSeparator=r;this.ArrayElementsSeparator=y;this.ObjectPropertiesSeparator=s;this.CommandsSeparator=B;this.CommandVariableSeparatorEncoded=this.urlEncode(t);this.CommandNameValueSeparatorEncoded=this.urlEncode(r);this.ArrayElementsSeparatorEncoded=this.urlEncode(y);this.ObjectPropertiesSeparatorEncoded=this.urlEncode(s);this.CommandsSeparatorEncoded=this.urlEncode(B);this.CSSHeader=dd;this.CSSBodyHeader=Gc;this.CSSGroupDraggingColumn=pb;this.CSSGroupingAreaDefaultColumn=I;this.CSSGroupingAreaColumn=xb;this.CSSGroupingAreaColumnLeft=W;this.CSSGroupingAreaColumnContent=H;this.CSSGroupingAreaColumnRight=U;this.CSSGroupingAreaColumnSpacer=M;this.CSSGroupingAreaTopArrow=ib;this.CSSGroupingAreaBottomArrow=T;this.CSSHeaderColumnHighlightedWhenGrouping=E;this.CSSGroupingAreaColumnHighlightedWhenDragging=D;this.CSSRecordGroupHeader=Eb;this.CSSRecordGroupFooter=Db;this.CSSRecord=ed;this.CSSRecordAlternate=Sb;this.CSSRecordSelected=bc;this.CSSRecordHover=vc;this.CSSCellPadding=tc;this.CSSCell=kd;this.CSSFirstCell=Mc;this.CSSRowEditTemplate=Ub;this.CSSCellTemporaryAdded=wb;this.CSSCellTemporaryEdited=mb;this.CSSCellTemporaryDeleted=gb;this.CSSInvisibleElement="ob_gIE";this.CSSResizableContent=Ob;this.CSSResizableContentWithWrap=N;this.CSSResizableContentForFirstColumn="ob_gRCFFC";this.CSSSelectionArea=ic;this.CSSActionLink=Ec;this.CSSEditControl=uc;this.CSSLoadingMessage=Zb;this.CSSResizeLines=wc;this.CSSResizingTooltip=Tb;this.CSSData=ld;this.CSSBodyFooter=Fc;this.CSSActionLinkFooter=Mb;this.CSSNavigationLink=ac;this.CSSNavigationLinkHover=qb;this.CSSFilterCriteria=Yb;this.CSSFilterCriteriaHover=ob;this.CSSDetailGridContainer=nb;this.CSSDetailGridLeftSpacer=hb;this.CSSDetailsGridExpanderContainingCell="ob_gDGECC";this.ImagesURL=hd;this.CSSNoRecordsMessage=Nb;this.CSSDetailsSection="ob_gDS";this.Localization_PageSizeText=kc;this.Localization_RecordsText=pc;this.Localization_ToText=Zc;this.Localization_OfText=Yc;this.Localization_PagesText=Hc;this.Localization_AddLink=Rc;this.Localization_EditLink=Nc;this.Localization_DeleteLink=yc;this.Localization_UpdateLink=Bc;this.Localization_CancelLink=xc;this.Localization_SaveLink=Oc;this.Localization_SaveAllLink=qc;this.Localization_CancelAllLink=cc;this.Localization_RemoveLink=Ac;this.Localization_ModifyLink=zc;this.Localization_UndeleteLink=lc;this.Localization_LoadingText=oc;this.Localization_NoRecordsText=dc;this.Localization_ResizeTooltipWidth=bb;this.Localization_ResizeTooltipPixels=Y;this.Localization_TypeValidationError=kb;this.Localization_MaxLengthValidationError=K;this.Localization_ButtonShowFilter=Gb;this.Localization_ButtonHideFilter=Fb;this.Localization_ButtonFilter=jc;this.Localization_ButtonRemoveFilter=sb;this.Localization_Grouping_GroupingAreaText=J;this.AllowRecordSelection=yb;this.AllowMultiRecordSelection=V;this.KeepSelectedRecords=Kb;this.AutoPostBackOnSelect=zb;if(this.AllowRecordSelection==true){this.SelectedRecordsCollection=[];this.LastSelectedRecord=null;this.SelectionArea=null;this.GridContainerWidthForSelection=null;this.MinYForSelection=null;this.MaxYForSelection=null;this.DraggingSelectionStarted=false;this.DraggingSelectionInProgress=false;this.SelectedRecords=[];this.PageSelectedRecords=[];this.NewSelectedRecords=null;if(this.ElementsClientIds.SelectedRecordsContainerID){this.SelectedRecordsContainer=oboutUtils.getById(this.ElementsClientIds.SelectedRecordsContainerID);this.RemovableDOMObjects.push(["SelectedRecordsContainer",true])}if(this.ElementsClientIds.SelectedRecordsIndexesContainerID){this.SelectedRecordsIndexesContainer=oboutUtils.getById(this.ElementsClientIds.SelectedRecordsIndexesContainerID);this.RemovableDOMObjects.push(["SelectedRecordsIndexesContainer",false])}this.WindowMouseY=null;this.AutomaticScrollingType=null;this.SelectionStartRecord=null;this.SelectionZoneStartRecordTop=null;this.SelectionZoneStartRecordOffsetHeight=null;this.SelectionZoneBorderHeight=0}this.EnableTypeValidation=Ab;if(this.EnableTypeValidation==true)this.TypeValidator=new OboutGridTypeValidator;this.ShowTooltipOnResize=Lb;this.AllowKeyNavigation=Qb;this.ExportedFilesTargetWindow=X;this.AllowGrouping=Cc;this.ShowGroupFooter=nc;this.HideColumnsWhenGrouping=eb;this.AllowGroupingChanges=L;this.HasDetailGrids=sc;this.DetailGridsLoadingMode=rb;this.ShowEmptyDetails=fc;this.MasterGridShowEmptyDetails=R;this.MasterGridID=a;this.ForeignKeys=gc;this.PreventDetailGridInitialization=false;this.AllowAddingRecords=Pb;this.AllowMultiRecordAdding=lb;this.NewRecordPosition=hc;if(this.AllowAddingRecords){this.cacheAddingRecordsElements();this.NewRecord_TemplateId=Hb;this.NewRecord_EditTemplateId=cb;this.AddRecordContainerBackup=null}else this.AddRecordButton=null;this.RecordsInAddMode=0;this.TopRecordsInAddMode=0;if(this.AllowMultiRecordAdding==true)this.RecordsTemporaryAdded=[];this.AddRecordButtonsCreated=false;this.AllowMultiRecordEditing=db;if(this.AllowMultiRecordEditing==true)this.RecordsTemporaryEdited=[];this.AllowMultiRecordDeleting=Z;if(this.AllowMultiRecordDeleting==true){this.RecordsTemporaryDeleted=[];this.TemporaryDeletedRecords=[]}(this.AllowMultiRecordAdding||this.AllowMultiRecordEditing||this.AllowMultiRecordDeleting)&&this.cacheMultiRecordElements();this.RowEditTemplateId=ec;if(this.RowEditTemplateId!=""){this.RowEditTemplateContainer=oboutUtils.getById(this.ElementsClientIds.RowEditTemplateContainerID);this.RemovableDOMObjects.push(["RowEditTemplateContainer",false])}this.ShowColumnsFooter=Xb;if(this.ShowColumnsFooter)this.GridColumnsFooterContainer=this.GridMainContainer.childNodes[this.getColumnsFooterContainerIndex(false)];this.GridBodyViewState=null;this.GridBodyViewStateIsSaved=false;this.IsTrackingGridBodyViewState=false;this.GridBodyCellsResized=false;this.ExposeSenderForClientEvents=S;this.OnBeforeClientSelect=typeof h=="function"?h:null;this.OnBeforeClientAdd=typeof n=="function"?n:null;this.OnBeforeClientInsert=typeof g=="function"?g:null;this.OnBeforeClientEdit=typeof l=="function"?l:null;this.OnBeforeClientUpdate=typeof i=="function"?i:null;this.OnBeforeClientDelete=typeof f=="function"?f:null;this.OnClientSelect=typeof w=="function"?w:null;this.OnClientAdd=typeof A=="function"?A:null;this.OnClientInsert=typeof v=="function"?v:null;this.OnClientEdit=typeof z=="function"?z:null;this.OnClientUpdate=typeof x=="function"?x:null;this.OnClientDelete=typeof u=="function"?u:null;this.OnBeforeClientCancelEdit=typeof b=="function"?b:null;this.OnClientCancelEdit=typeof m=="function"?m:null;this.OnBeforeClientCancelAdd=typeof d=="function"?d:null;this.OnClientCancelAdd=typeof o=="function"?o:null;this.OnClientPopulateControls=typeof c=="function"?c:null;this.OnClientCallback=typeof p=="function"?p:null;this.OnClientCallbackError=typeof e=="function"?e:null;this.OnClientExportStartFunction=typeof k=="function"?k:null;this.OnClientExportFinishFunction=typeof j=="function"?j:null;this.ClientSideEvents={};this.ClientSideEvents.OnFiltering=typeof C=="function"?C:null;this.ClientSideEvents.OnPopulatingFilterFields=typeof q=="function"?q:null;this.Width=od;this.Height=nd;this.ScrollHeight=Kc;this.ScrollWidth=Qc;this.ScrollTop=cd;this.ScrollLeft=Wc;this.NumberOfFixedColumns=Cb;this.FixedColumnsPosition=Bb;this.EnableVirtualScrolling=vb;this.UsePagingForVirtualScrolling=Q;if(this.NumberOfFixedColumns>0){this.ScrolledColumnsWidth=0;this.ScrolledColumnsIndexes=",";this.ArrColumnsWidthBeforeScrolling=[];this.ArrHorizontalScrolledColumns=[]}this.AutomaticScrollingApplied=false;this.AutomaticScrollingStarted=false;this.ScrollingDummyColumn=oboutUtils.getById(this.ElementsClientIds.HeaderScrollingCellID);this.RemovableDOMObjects.push(["ScrollingDummyColumn",true]);this.ScrollingDummyColumnInitialized=false;this.isFFWithDoctype=false;this.EnableRecordHover=Vb;this.CSSRecordHoverBackgroundImage=null;this.CSSRecordHoverBackgroundColor=null;this.CSSRecordHoverColor=null;this.CSSPreviousRecordBackgroundImage=null;this.CSSPreviousRecordBackgroundColor=null;this.CSSPreviousRecordColor=null;this.LastHighlightedRecord=null;this.CachedStylesFromCssClasses=null;if(this.AllowFiltering){this.FilterType=Xc;this.PreviousFilterButtonsContainerContent=null;this.FilteringButtonsConfigurationContainerTempValue=F;this.FilterShowButton_TemplateId=P;this.FilterButton_TemplateId=jb;this.FilterHideButton_TemplateId=O;this.FilterRemoveButton_TemplateId=G}this.ShowLoadingMessage=Rb;this.Rows=null;this.OnLoadExecuted=false;this.bFFHasWrapColumns=false;this.GenerateRecordIds=Wb;this.ColumnsWidthSaved=false;this.HeaderCellsWidthInited=false;this.BodyCellDivsWidthInited=false;this.DivsLargerThanTdChecked=false;this.ColumnsVisibleStateContainer=oboutUtils.getById(this.ElementsClientIds.ColumnsVisibleStateContainerID);this.RemovableDOMObjects.push(["ColumnsVisibleStateContainer",true]);this.ColumnsCollection=ad;this.ColumnsCollectionIndexedByDataField=null;this.IndexOfFirstVisibleColumn=ab;this.IndexOfLastVisibleColumn=fb;this.RecordInEditMode=null;this.RecordInEditModeBackup=null;this.RecordInEditModePreviousValues=null;this.RecordTempValues=null;this.RecordInAddMode=mc;this.AscSortingArrow=new Image;this.DescSortingArrow=new Image;this.PlaceHolder=new Image;this.AscSortingArrow.src=this.ImagesURL.SortingAsc;this.DescSortingArrow.src=this.ImagesURL.SortingDesc;this.PlaceHolder.src=this.ImagesURL.Placeholder;this.PreviousSortedColumn=null;this.PreviousSortedOrder=null;this.PreviousMouseDownEventHandler=null;this.PreviousMouseUpEventHandler=null;this.PreviousMouseMoveEventHandler=null;this.PreviousOnSelectStartEventHandler=null;this.PreviousOnSelectStartEventHandlerSaved=null;this.PreviousMouseCursor=null;this.ColumnResizeIndicator=null;this.ColumnStaticIndicator=null;this.ColumnResizeTooltip=null;this.ResizeableColumn=null;this.GridBodyBackup=null;this.BackupError=null;this.BackupViewState=null;this.ColumnsWidthContainer=oboutUtils.getById(this.ElementsClientIds.ColumnsWidthContainerID);this.RemovableDOMObjects.push(["ColumnsWidthContainer",true]);this.ColumnsWidthContainer.value="";this.CellDivsWidthContainer=oboutUtils.getById(this.ElementsClientIds.CellDivsWidthContainerID);this.RemovableDOMObjects.push(["CellDivsWidthContainer",true]);this.CSSRecordHoverInfoLoaded=false;this.EditTemplateContainer=oboutUtils.getById(this.ElementsClientIds.EditTemplatesContainerID);this.RemovableDOMObjects.push(["EditTemplateContainer",true]);this.ViewState=null;this.bCallbackInitiated=false;this.XMLString=null;this.XMLRoot=null;this.ForcedLoading=Pc;this.initGrid();this.serializeColumns()};oboutGrid.prototype.getElementsClientIds=function(){this.ElementsClientIds={};if(this.ElementsClientIdsContainer!=null)for(var a=0;a<this.ElementsClientIdsContainer.childNodes.length;a++)this.ElementsClientIds[this.ElementsClientIdsContainer.childNodes[a].id.replace("ob_"+this.ID+"_","")]=this.ElementsClientIdsContainer.childNodes[a].firstChild?this.ElementsClientIdsContainer.childNodes[a].firstChild.nodeValue:""};oboutGrid.prototype.initGrid=function(){this.detectBrowsers();this.applyCrossBrowserFixes();this.ajax=new OboutGridAjax;this.cacheElements();this.initFeatureRelatedProperties();this.assignEvents();this.loadViewState();this.CallbackMode==false&&this.executeClientEvents(this.GridMainContainer);this.MasterGridID&&this.ForcedLoading&&this.executeOnLoadActions(false)};oboutGrid.prototype.initMembers=function(){this.CachedNoRecordsRow=null};oboutGrid.prototype.detectBrowsers=function(){this.isIE=navigator.userAgent.toLowerCase().indexOf("msie")==-1?false:true;this.isIE6=navigator.userAgent.toLowerCase().indexOf("msie 6.0")==-1?false:true;this.isIE7=navigator.userAgent.toLowerCase().indexOf("msie 7.0")==-1?false:true;this.isIE8=navigator.userAgent.toLowerCase().indexOf("msie 8.0")==-1?false:true;this.isSafari=navigator.userAgent.toLowerCase().indexOf("safari")==-1?false:true;this.isOpera=navigator.userAgent.toLowerCase().indexOf("opera")==-1?false:true;this.isFF=navigator.userAgent.toLowerCase().indexOf("firefox")==-1?false:true;this.isFF3=navigator.userAgent.toLowerCase().indexOf("firefox/3")==-1?false:true;this.isCamino=navigator.userAgent.toLowerCase().indexOf("camino")==-1?false:true;this.isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")==-1?false:true;if(this.isChrome)this.isSafari=false};oboutGrid.prototype.initFeatureRelatedProperties=function(){this.AllowRecordSelection==true&&this.KeepSelectedRecords==true&&this.initRecordSelection();this.AllowFiltering==true&&this.initFilterRelatedProperties();this.AllowKeyNavigation==true&&this.initKeyNavigationRelatedProperties();(this.AllowGrouping==true||this.AllowColumnReordering==true)&&this.initGroupingRelatedProperties();(this.HasDetailGrids==true||this.MasterGridID)&&this.initMasterDetailRelatedProperties()};oboutGrid.prototype.loadViewState=function(){};oboutGrid.prototype.cacheElements=function(){this.CachedImagesURL={};if(this.GridFooterContainer){var a=this.getPagingButtonsContainer("");if(a!=null&&a.childNodes.length>0){this.cacheImageURL("First_Normal");this.cacheImageURL("First_Over");this.cacheImageURL("First_Pressed");this.cacheImageURL("First_Disabled");this.cacheImageURL("Previous_Normal");this.cacheImageURL("Previous_Over");this.cacheImageURL("Previous_Pressed");this.cacheImageURL("Previous_Disabled");this.cacheImageURL("Next_Normal");this.cacheImageURL("Next_Over");this.cacheImageURL("Next_Pressed");this.cacheImageURL("Next_Disabled");this.cacheImageURL("Last_Normal");this.cacheImageURL("Last_Over");this.cacheImageURL("Last_Pressed");this.cacheImageURL("Last_Disabled")}}if(this.GridTopFooterContainer){var a=this.getPagingButtonsContainer("Top");if(a!=null&&a.childNodes.length>0){this.cacheImageURL("First_Normal_Top");this.cacheImageURL("First_Over_Top");this.cacheImageURL("First_Pressed_Top");this.cacheImageURL("First_Disabled_Top");this.cacheImageURL("Previous_Normal_Top");this.cacheImageURL("Previous_Over_Top");this.cacheImageURL("Previous_Pressed_Top");this.cacheImageURL("Previous_Disabled_Top");this.cacheImageURL("Next_Normal_Top");this.cacheImageURL("Next_Over_Top");this.cacheImageURL("Next_Pressed_Top");this.cacheImageURL("Next_Disabled_Top");this.cacheImageURL("Last_Normal_Top");this.cacheImageURL("Last_Over_Top");this.cacheImageURL("Last_Pressed_Top");this.cacheImageURL("Last_Disabled_Top")}}};oboutGrid.prototype.cacheImageURL=function(a){var b=new Image;b.src=this.ImagesURL[a];this.CachedImagesURL[a]=b};oboutGrid.prototype.cacheAddingRecordsElements=function(){this.AddRecordButtonContainer=oboutUtils.getById(this.ElementsClientIds.FooterActionLinksContainerID);this.RemovableDOMObjects.push(["AddRecordButtonContainer",false]);this.AddRecordButton=oboutUtils.getById(this.ElementsClientIds.AddRecordLinkID);this.RemovableDOMObjects.push(["AddRecordButton",false]);this.TopAddRecordButtonContainer=oboutUtils.getById(this.ElementsClientIds.TopFooterActionLinksContainerID);this.RemovableDOMObjects.push(["TopAddRecordButtonContainer",false]);this.TopAddRecordButton=oboutUtils.getById(this.ElementsClientIds.TopAddRecordLinkID);this.RemovableDOMObjects.push(["TopAddRecordButton",false]);if(this.ElementsClientIds.NewRecordEditTemplateContainerID){this.NewRecord_EditTemplateContainer=oboutUtils.getById(this.ElementsClientIds.NewRecordEditTemplateContainerID);this.RemovableDOMObjects.push(["NewRecord_EditTemplateContainer",false])}else if(!this.MasterGridID)this.NewRecord_EditTemplateContainer=null;if(this.ElementsClientIds.TopNewRecordEditTemplateContainerID){this.TopNewRecord_EditTemplateContainer=oboutUtils.getById(this.ElementsClientIds.TopNewRecordEditTemplateContainerID);this.RemovableDOMObjects.push(["TopNewRecord_EditTemplateContainer",false])}else if(!this.MasterGridID)this.TopNewRecord_EditTemplateContainer=null};oboutGrid.prototype.cacheMultiRecordElements=function(){this.MultiRecordsSaveCancelButtonsContainer=oboutUtils.getById(this.ElementsClientIds.MultiActionLinksContainerID);this.RemovableDOMObjects.push(["MultiRecordsSaveCancelButtonsContainer",false]);this.TopMultiRecordsSaveCancelButtonsContainer=oboutUtils.getById(this.ElementsClientIds.TopMultiActionLinksContainerID);this.RemovableDOMObjects.push(["TopMultiRecordsSaveCancelButtonsContainer",false]);this.ColumnMultiRecordTemplateSettingsContainer=oboutUtils.getById(this.ElementsClientIds.MultiRecordTemplateSettingsContainerID);this.RemovableDOMObjects.push(["ColumnMultiRecordTemplateSettingsContainer",false])};oboutGrid.prototype.assignEvents=function(){this.assignHeaderEvents();this.assignBodyEvents();this.assignFooterEvents();var a=this;if(!this.ForcedLoading){if(this.isIE==true)if(window.onload==null||window.onload.toString()=="function (){}")window.onload=function(){a.executeOnLoadActions(false)};this.addEvent(window,"load",function(){a.executeOnLoadActions(true)});this.addEvent(window,"unload",function(){a.executeOnUnLoadActions(true)});try{if(typeof Sys!="undefined")if(Sys&&Sys.WebForms&&Sys.WebForms.PageRequestManager){Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){a.executeOnLoadActions(true)});Sys.WebForms.PageRequestManager.getInstance().add_pageLoading(function(c,b){a.destructControlAfterAJAXPostback(a,b)})}}catch(b){}}};oboutGrid.prototype.assignHeaderEvents=function(){var b=this;if(this.GridHeaderContainer!=null){this.TempHeaderRow=this.getHeaderRow();this.RemovableDOMObjects.push(["TempHeaderRow",false]);var f=this.TempHeaderRow.childNodes.length;if(this.AllowSorting==true)for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!=""){this.TempHeaderCell=this.TempHeaderRow.childNodes[a];this.TempHeaderCell.onclick=function(a){b.sortHeaderColumn(a,this)};this.TempHeaderCell.onselectstart=function(){return false};this.RemovableDOMObjects.push(["TempHeaderCell",false])}if(this.AllowColumnResizing==true)for(var a=0;a<this.ColumnsCollection.length-1;a++){var d=this.getHeaderCellSeparator(a);d.onmousedown=function(a){b.startColumnResizing(a,this)}}(this.AllowGrouping==true&&this.AllowGroupingChanges||this.AllowColumnReordering)&&this.addDragAndDropFunctionalityToHeaders();for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].ColumnType=="CheckBoxSelectColumn"&&this.ColumnsCollection[a].ShowHeaderCheckBox){var c=this.getCheckBoxSelector(this.TempHeaderRow.childNodes[a]);if(c.type=="checkbox"){this.stopAllEventsPropagation(c);c.onclick=function(){b.toggleAllCheckBoxSelection(this)}}else{var e=eval(c.value);e.ClientSideEvents.OnCheckedChanged=function(a){!b._preventHeaderCheckBoxHandler&&b.toggleAllCheckBoxSelection(a)}}}}};oboutGrid.prototype.detachHeaderEventHandlers=function(){if(this.GridHeaderContainer!=null){var b=this.getHeaderRow(),e=b.childNodes.length;if(this.AllowSorting==true)for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!=""){var c=b.childNodes[a];c.onclick=null;c.onselectstart=null}if(this.AllowColumnResizing==true)for(var a=0;a<this.ColumnsCollection.length-1;a++){var d=this.getHeaderCellSeparator(a);d.onmousedown=null}}};oboutGrid.prototype.assignBodyEvents=function(){var a=this;this.TempGridBody=this.getBodyTableBody();this.RemovableDOMObjects.push(["TempGridBody",false]);var f=false;if(this.AllowRecordSelection==true){for(var b=0;b<this.TempGridBody.childNodes.length;b++)if(this.isBodyRecord(this.TempGridBody.childNodes[b])){this.TempGridBody.childNodes[b].onmousedown=function(b){if(!b)b=window.event;if(b.ctrlKey==true||b.shiftKey==true)if(a.PreviousOnSelectStartEventHandlerSaved==null){a.PreviousOnSelectStartEventHandler=document.onselectstart;document.onselectstart=function(){return false};a.PreviousOnSelectStartEventHandlerSaved=true}if(a.AllowMultiRecordSelection==true&&a.IsTrackingGridBodyViewState==false){a.PreviousMouseUpEventHandler=document.onmouseup;a.PreviousMouseMoveEventHandler=null;a.showSelectionArea(this,b.ctrlKey==true||b.shiftKey==true)}return false};this.TempGridBody.childNodes[b].onclick=function(b){(a.AllowMultiRecordSelection==false||a.DraggingSelectionStarted==false)&&a.IsTrackingGridBodyViewState==false&&a.selectRecordByClick(b,this)};if(this.AllowMultiRecordSelection==true)this.TempGridBody.childNodes[b].onmouseup=function(){if(this.IsTrackingGridBodyViewState==false){document.onselectstart=a.PreviousOnSelectStartEventHandler;a.PreviousOnSelectStartEventHandler=null;a.PreviousOnSelectStartEventHandlerSaved=null}};if(this.EnableRecordHover==true){this.TempGridBody.childNodes[b].onmouseover=function(){a.manageHoverEffects(this,true)};this.TempGridBody.childNodes[b].onmouseout=function(){a.manageHoverEffects(this,false)};f=true}}for(var b=0;b<this.ColumnsCollection.length;b++){var e=false;if(this.ColumnsCollection[b].AllowEdit==true||this.ColumnsCollection[b].AllowDelete==true)e=true;else if(this.ColumnsCollection[b].ColumnType=="CheckBoxSelectColumn")e=true;if(e)for(var d=b,c=0;c<this.TempGridBody.childNodes.length;c++)if(this.isBodyRecord(this.TempGridBody.childNodes[c])&&this.TempGridBody.childNodes[c].childNodes[d]){this.TempGridBodyCell=this.TempGridBody.childNodes[c].childNodes[d];if(this.ColumnsCollection[d].ColumnType=="CheckBoxSelectColumn")this.TempGridBodyCell=this.getCheckBoxSelector(this.TempGridBodyCell);else this.stopAllEventsPropagation(this.TempGridBodyCell);if(this.ColumnsCollection[d].ColumnType=="CheckBoxSelectColumn")if(this.TempGridBodyCell.type=="checkbox"){this.stopAllEventsPropagation(this.TempGridBodyCell);this.TempGridBodyCell.onclick=function(b){a.toggleRecordSelection(this,b)}}else{var g=eval(this.TempGridBodyCell.value);this.stopAllEventsPropagation(this.TempGridBodyCell.nextSibling,true);g.Container.onclick=function(c){var b=eval(this.previousSibling.value);b.handleClick();a.stopEventPropagation(c)};g.ClientSideEvents.OnCheckedChanged=function(b){a.toggleRecordSelection(b)}}}}}this.AllowGrouping==true;if(this.EnableRecordHover==true&&f==false)for(var b=0;b<this.TempGridBody.childNodes.length;b++){this.TempGridBody.childNodes[b].onmouseover=function(){a.manageHoverEffects(this,true)};this.TempGridBody.childNodes[b].onmouseout=function(){a.manageHoverEffects(this,false)}}};oboutGrid.prototype.detachBodyEventHandlers=function(){tempGridBody=this.getBodyTableBody();var c=false;if(this.AllowRecordSelection==true){for(var a=0;a<tempGridBody.childNodes.length;a++)if(this.isBodyRecord(tempGridBody.childNodes[a])){tempGridBody.childNodes[a].onmousedown=null;tempGridBody.childNodes[a].onclick=null;if(this.AllowMultiRecordSelection==true)tempGridBody.childNodes[a].onmouseup=null;if(this.EnableRecordHover==true){tempGridBody.childNodes[a].onmouseover=null;tempGridBody.childNodes[a].onmouseout=null;c=true}}for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].AllowEdit==true||this.ColumnsCollection[a].AllowDelete==true)for(var d=a,b=0;b<tempGridBody.childNodes.length;b++)if(tempGridBody.childNodes[b].childNodes[d]){tempGridBodyCell=tempGridBody.childNodes[b].childNodes[d];this.detachAllEventHandlers(tempGridBodyCell)}}if(this.EnableRecordHover==true&&c==false)for(var a=0;a<tempGridBody.childNodes.length;a++){tempGridBody.childNodes[a].onmouseover=null;tempGridBody.childNodes[a].onmouseout=null}};oboutGrid.prototype.attachEventsToFooter=function(c){var a=this,h=c==""?"Top":"";if(this.AllowPageSizeSelection){this.PageSize=this.getPageSize();if(this[c+"PageSizeSelector"])this[c+"PageSizeSelector"].onchange=function(){a.PageSelector.value=0;if(a[h+"PageSizeSelector"]!=null){a[h+"PageSizeSelector"].value(a[c+"PageSizeSelector"].value(),false);a[h+"PageSizeSelector"].InitialSelectedIndex=null}a.initiateCallback()}}if(this.AllowPaging){var g=this.getPagingButtonsContainer(c);if(g!=null&&g.childNodes.length>0){for(var e=null,d=[],f=g.getElementsByTagName("DIV"),b=0;b<f.length;b++)if(f[b].className.indexOf("ob_gPBC")!=-1)d.push(f[b]);else if(f[b].className=="ob_gPLC")e=f[b];for(var b=0;b<e.childNodes.length;b++)if(e.childNodes[b].className==this.CSSNavigationLink||e.childNodes[b].className==this.CSSNavigationLinkHover){e.childNodes[b].onclick=function(){a.PageSelector.value=this.firstChild.nodeValue-1;a.initiateCallback()};e.childNodes[b].onmouseover=function(){this.className=a.CSSNavigationLinkHover};e.childNodes[b].onmouseout=function(){this.className=a.CSSNavigationLink}}if(parseInt(this.TotalRecords)&&this.PageSize!=-1){if(this.PageSelector.value>0){d[3].firstChild.onclick=function(){a.loadFirstPage()};this.enableStatesForButton(d[3].firstChild,"First",c)}if(this.PageSelector.value>0){d[2].firstChild.onclick=function(){a.loadPreviousPage()};this.enableStatesForButton(d[2].firstChild,"Previous",c)}if(this.PageSelector.value<parseFloat(parseFloat(this.TotalRecords)/parseFloat(this.PageSize))-1){d[1].firstChild.onclick=function(){a.loadNextPage()};this.enableStatesForButton(d[1].firstChild,"Next",c)}if(this.PageSelector.value!=Math.ceil(parseFloat(parseFloat(this.TotalRecords)/parseFloat(this.PageSize))-1)){d[0].firstChild.onclick=function(){a.loadLastPage()};this.enableStatesForButton(d[0].firstChild,"Last",c)}}}}};oboutGrid.prototype.assignFooterEvents=function(){this.GridFooterContainer!=null&&this.attachEventsToFooter("");this.GridTopFooterContainer!=null&&this.attachEventsToFooter("Top")};oboutGrid.prototype.enableStatesForButton=function(c,b,a){if(typeof a=="undefined")a="";if(a!="")a="_"+a;var g=this,e=this.CachedImagesURL[b+"_Normal"+a].src,f=this.CachedImagesURL[b+"_Over"+a].src,d=this.CachedImagesURL[b+"_Pressed"+a].src;c.onmouseover=function(){this.src=f};c.onmouseout=function(){this.src=e};c.onmousedown=function(){this.src=d}};oboutGrid.prototype.detachFooterEventHandlers=function(){if(this.GridFooterContainer!=null){if(this.AllowPageSizeSelection)this.PageSizeSelector.onchange=null;if(this.AddRecordButton)if(this.CallbackMode==true)this.AddRecordButton.onclick=null}};oboutGrid.prototype.executeOnLoadActions=function(b){if(b==true&&this.OnLoadExecuted==true)return;(this.ScrollHeight!="0px"||this.ScrollWidth!="0px"||this.Height!="0px")&&this.initializeScrollingSettings();this.getClientSideModel();this.toggleHeaderCheckBoxSelection();this.saveColumnsWidth();if(this.EnableRecordHover==true||this.AllowKeyNavigation==true){if(this.CSSRecordHoverInfoLoaded==false){var a=document.createElement("DIV");a.className=this.CSSRecordHover;document.body.appendChild(a);this.CSSRecordHoverBackgroundColor=this.getStyle(a,"background-color");this.CSSRecordHoverBackgroundImage=this.getStyle(a,"background-image");this.CSSRecordHoverColor=this.getStyle(a,"color");document.body.removeChild(a);a=null;this.CSSRecordHoverInfoLoaded=true}this.CSSPreviousRecordBackgroundImage=null;this.CSSPreviousRecordBackgroundColor=null;this.CSSPreviousRecordColor=null;this.LastHighlightedRecord=null}this.OnLoadExecuted=true};oboutGrid.prototype.executeOnUnLoadActions=function(a){try{a&&this.detachHeaderEventHandlers();this.detachBodyEventHandlers();this.detachFooterEventHandlers();this.removeDOMObjectReferences(a)}catch(b){}};oboutGrid.prototype.destructControlAfterAJAXPostback=function(b,a){if(a._panelsUpdating)for(var c=0;c<a._panelsUpdating.length;c++)b.isInsideAJAXPostback(b.GridMainContainer,a._panelsUpdating[c])&&b.executeOnUnLoadActions(true)};oboutGrid.prototype.isInsideAJAXPostback=function(a,b){while(a){if(a==b)return true;a=a.parentNode}return false};oboutGrid.prototype.removeDOMObjectReferences=function(b){for(var a=0;a<this.RemovableDOMObjects.length;a++)if(b||this.RemovableDOMObjects[a][1]==false)this[this.RemovableDOMObjects[a][0]]=null};oboutGrid.prototype.executeOnCallbackEvents=function(){this.getClientSideModel();if(this.AllowRecordSelection==true){this.KeepSelectedRecords==true&&this.initRecordSelection();this.toggleHeaderCheckBoxSelection()}this.AllowAddingRecords&&this.cacheAddingRecordsElements();(this.AllowMultiRecordAdding||this.AllowMultiRecordEditing||this.AllowMultiRecordDeleting)&&this.cacheMultiRecordElements();this.AllowFiltering==true&&this.executeOnCallbackFilterEvents();if(this.JumpToPageTextbox&&this.ElementsClientIds.ManualPagingTextboxID)this.JumpToPageTextbox=eval(this.ElementsClientIds.ManualPagingTextboxID);if(this.TopJumpToPageTextbox&&this.ElementsClientIds.TopManualPagingTextboxID)this.TopJumpToPageTextbox=eval(this.ElementsClientIds.TopManualPagingTextboxID);this.assignBodyEvents();this.assignFooterEvents();(this.HasDetailGrids||this.MasterGridID)&&this.executeOnLoadMasterDetailActions();this.ScrollWidth!="0px"&&this.NumberOfFixedColumns&&this.hideScrolledColumns();this.ensureVerticalScrollingInSynch();(this.AllowMultiRecordAdding||this.AllowMultiRecordEditing||this.AllowMultiRecordDeleting)&&this.cancelGridBodyViewStateTracking();if(this.EnableRecordHover==true||this.AllowKeyNavigation==true){this.CSSPreviousRecordBackgroundImage=null;this.CSSPreviousRecordBackgroundColor=null;this.CSSPreviousRecordColor=null;this.LastHighlightedRecord=null}};oboutGrid.prototype.hasWrapColumns=function(){for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Wrap==true)return true;return false};oboutGrid.prototype.getBodyFirstRecord=function(){var b=this.getBody(),a=b.firstChild;while(a!=null&&(a.className==this.CSSRecordGroupHeader||a.className==this.CSSDetailsSection||a.firstChild!=null&&a.firstChild.className==this.CSSNoRecordsMessage))a=a.nextSibling;return a};oboutGrid.prototype.isBodyRecord=function(a){return a!=null&&a.nodeName=="TR"&&a.className!="ob_gDGC"&&a.className!=this.CSSRecordGroupHeader&&a.className!=this.CSSRecordGroupFooter&&a.className!=this.CSSDetailsSection&&a.firstChild!=null&&a.firstChild.className!=this.CSSNoRecordsMessage&&a.firstChild.firstChild!=null&&a.firstChild.firstChild.className!=this.CSSRowEditTemplate?true:false};oboutGrid.prototype.isBodyRecordWithDataCells=function(a){return a!=null&&a.nodeName=="TR"&&a.className!="ob_gDGC"&&a.className!=this.CSSRecordGroupHeader&&a.className!=this.CSSDetailsSection&&a.firstChild!=null&&a.firstChild.className!=this.CSSNoRecordsMessage&&a.firstChild.firstChild!=null&&a.firstChild.firstChild.className!=this.CSSRowEditTemplate?true:false};oboutGrid.prototype.manageHoverEffects=function(a,b){if(b==true&&a!=this.LastHighlightedRecord){if(this.DraggingSelectionInProgress==true)return;if(this.LastHighlightedRecord!=null){if(this.CSSPreviousRecordBackgroundImage!=null)this.LastHighlightedRecord.style.backgroundImage=this.CSSPreviousRecordBackgroundImage;if(this.CSSPreviousRecordBackgroundColor!=null)this.LastHighlightedRecord.style.backgroundColor=this.CSSPreviousRecordBackgroundColor;if(this.CSSPreviousRecordColor!=null)this.LastHighlightedRecord.style.color=this.CSSPreviousRecordColor;this.LastHighlightedRecord=null}if(this.CSSRecordHoverBackgroundImage!=null){this.CSSPreviousRecordBackgroundImage=this.getCachedStyleFromCssClass(a,"background-image");a.style.backgroundImage=this.CSSRecordHoverBackgroundImage}if(this.CSSRecordHoverBackgroundColor!=null){this.CSSPreviousRecordBackgroundColor=this.getCachedStyleFromCssClass(a,"background-color");a.style.backgroundColor=this.CSSRecordHoverBackgroundColor}if(this.CSSRecordHoverColor!=null){this.CSSPreviousRecordColor=this.getCachedStyleFromCssClass(a,"color");a.style.color=this.CSSRecordHoverColor}this.LastHighlightedRecord=a}else if(b==false&&(this.DraggingSelectionStarted==false||a==this.LastHighlightedRecord)){if(this.CSSPreviousRecordBackgroundImage!=null)a.style.backgroundImage=this.CSSPreviousRecordBackgroundImage;if(this.CSSPreviousRecordBackgroundColor!=null)a.style.backgroundColor=this.CSSPreviousRecordBackgroundColor;if(this.CSSPreviousRecordColor!=null)a.style.color=this.CSSPreviousRecordColor;this.LastHighlightedRecord=null}};oboutGrid.prototype.updateLastHighlightedRecordInfo=function(a){this.CSSPreviousRecordBackgroundImage=this.getCachedStyleFromCssClass(a,"background-image");this.CSSPreviousRecordBackgroundColor=this.getCachedStyleFromCssClass(a,"background-color");this.CSSPreviousRecordColor=this.getCachedStyleFromCssClass(a,"color")};oboutGrid.prototype.getCachedStyleFromCssClass=function(a,b){if(!a)return;if(this.CachedStylesFromCssClasses==null)this.CachedStylesFromCssClasses={};if(this.CachedStylesFromCssClasses[a.className]==null)this.CachedStylesFromCssClasses[a.className]={};if(this.CachedStylesFromCssClasses[a.className][b]==null)this.CachedStylesFromCssClasses[a.className][b]=this.getStyle(a,b);return this.CachedStylesFromCssClasses[a.className][b]};oboutGrid.prototype.restoreRecordStateBeforeHover=function(a){var c=this.getElementIndex(a),b=this.getElementIndex(a);if(c==b){if(this.CSSRecordHoverBackgroundImage!=null)a.style.backgroundImage="";if(this.CSSRecordHoverBackgroundColor!=null)a.style.backgroundColor="";if(this.CSSRecordHoverColor!=null)a.style.color=""}};oboutGrid.prototype.clearHoverEffect=function(a){if(this.CSSRecordHoverBackgroundImage!=null)a.style.backgroundImage="";if(this.CSSRecordHoverBackgroundColor!=null)a.style.backgroundColor="";if(this.CSSRecordHoverColor!=null)a.style.color=""};oboutGrid.prototype.highlightRecordUp=function(){if(this.LastHighlightedRecord!=null){if(this.LastHighlightedRecord.previousSibling!=null)a=this.LastHighlightedRecord.previousSibling}else var a=this.getBodyTableBody().lastChild;a!=null&&this.manageHoverEffects(a,true)};oboutGrid.prototype.highlightRecordDown=function(){if(this.LastHighlightedRecord!=null){if(this.LastHighlightedRecord.nextSibling!=null)a=this.LastHighlightedRecord.nextSibling}else var a=this.getBodyTableBody().firstChild;a!=null&&this.manageHoverEffects(a,true)};oboutGrid.prototype.getColumnIndexByDataField=function(b){for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField==b)return a;return-1};oboutGrid.prototype.showColumn=function(a,e,d){if(parseInt(a)!=a)a=this.getColumnIndexByDataField(a);if(this.ColumnsCollection[a]==null)return;if(typeof e=="undefined")e=true;if(typeof d=="undefined")d=true;if(this.ColumnsCollection[a].Visible==false){var c=this.ColumnsCollection[a];if(e)this.GridMainContainer.style.width=this.GridMainContainer.offsetWidth+parseInt(this.ColumnsCollection[a].Width)+"px";if(this.GridHeaderContainer!=null){var h=this.getHeaderCell(a);h.className=h.className.replace(c.CssClassHidden,c.CssClass);var b=this.getHeaderCellSeparator(a);if(b)b.style.display=""}this.showBodyColumn(a);if(this.ShowColumnsFooter){var f=this.getColumnsFooterCell(a);f.className=f.className.replace(c.CssClassHidden,c.CssClass);var b=this.getColumnsFooterCellSeparator(a);if(b)b.style.display=""}if(this.AllowFiltering){var g=this.getFilterCell(a);g.className=g.className.replace(c.CssClassHidden,c.CssClass);var b=this.getFilterCellSeparator(a);if(b)b.style.display=""}this.ColumnsCollection[a].Visible=true;if(d)this.ColumnsCollection[a].RealVisible=this.ColumnsCollection[a].Visible;this.recalculateCellSeparatorsPosition();this.persistColumnsVisibleState();if(a<this.IndexOfFirstVisibleColumn){this.applyCssClassToColumn(this.IndexOfFirstVisibleColumn,"ob_gC_Fc",true);this.applyCssClassToColumn(a,"ob_gC_Fc",false);this.IndexOfFirstVisibleColumn=a}else if(a>this.IndexOfLastVisibleColumn){this.applyCssClassToColumn(this.IndexOfLastVisibleColumn,"ob_gC_Lc",true);this.applyCssClassToColumn(a,"ob_gC_Lc",false);this.IndexOfLastVisibleColumn=a}}};oboutGrid.prototype.showBodyColumn=function(b){var d=this.getBodyTableBody(),e=this.getBodyHeadCell(b);if(!a)a=e.className.replace("_I","");e.className=a;for(var g=this.ColumnsCollection[b],a=null,c=0;c<d.childNodes.length;c++)if(this.isBodyRecordWithDataCells(d.childNodes[c])){if(!a)a=d.childNodes[c].childNodes[b].className.replace(g.CssClassHidden,g.CssClass);d.childNodes[c].childNodes[b].className=a}var f=this.getBodyCellSeparatorByCellIndex(b);if(f)f.style.display="";if(this.IsTrackingGridBodyViewState)this.ColumnsCollection[b].VisibilityHasChangedDuringBodyViewStateTracking=true};oboutGrid.prototype.hideColumn=function(a,h,d){if(parseInt(a)!=a)a=this.getColumnIndexByDataField(a);if(this.ColumnsCollection[a]==null)return;if(typeof h=="undefined")h=true;if(typeof d=="undefined")d=true;if(this.ColumnsCollection[a].Visible==true){var b=this.ColumnsCollection[a];if(h)this.GridMainContainer.style.width=this.GridMainContainer.offsetWidth-parseInt(b.Width)+"px";if(this.GridHeaderContainer!=null){var g=this.getHeaderCell(a);if(g.className.indexOf(b.CssClassHidden)==-1)g.className=g.className.replace(b.CssClass,b.CssClassHidden);var c=this.getHeaderCellSeparator(a);if(c)c.style.display="none"}this.hideBodyColumn(a);if(this.ShowColumnsFooter){var e=this.getColumnsFooterCell(a);if(e.className.indexOf(b.CssClassHidden)==-1)e.className=e.className.replace(b.CssClass,b.CssClassHidden);var c=this.getColumnsFooterCellSeparator(a);if(c)c.style.display="none"}if(this.AllowFiltering){var f=this.getFilterCell(a);if(f.className.indexOf(b.CssClassHidden)==-1)f.className=f.className.replace(b.CssClass,b.CssClassHidden);var c=this.getFilterCellSeparator(a);if(c)c.style.display="none"}this.ColumnsCollection[a].Visible=false;if(d)this.ColumnsCollection[a].RealVisible=this.ColumnsCollection[a].Visible;this.recalculateCellSeparatorsPosition();this.persistColumnsVisibleState();if(a==this.IndexOfFirstVisibleColumn){this.applyCssClassToColumn(a,"ob_gC_Fc",true);var j=this.getNextVisibleColumnIndex(a);this.applyCssClassToColumn(j,"ob_gC_Fc",false);this.IndexOfFirstVisibleColumn=j}else if(a==this.IndexOfLastVisibleColumn){this.applyCssClassToColumn(a,"ob_gC_Lc",true);var i=this.getPreviousVisibleColumnIndex(a);this.applyCssClassToColumn(i,"ob_gC_Lc",false);this.IndexOfLastVisibleColumn=i}}};oboutGrid.prototype.hideBodyColumn=function(b){var d=this.getBodyTableBody(),e=this.getBodyHeadCell(b);if(e.className.indexOf("_I")==-1)e.className=e.className+"_I";for(var f=this.ColumnsCollection[b],a=null,c=0;c<d.childNodes.length;c++)if(this.isBodyRecordWithDataCells(d.childNodes[c])){if(!a){a=d.childNodes[c].childNodes[b].className;if(a.indexOf(f.CssClassHidden)==-1)a=a.replace(f.CssClass,f.CssClassHidden)}d.childNodes[c].childNodes[b].className=a}var g=this.getBodyCellSeparatorByCellIndex(b);if(g)g.style.display="none";if(this.IsTrackingGridBodyViewState)this.ColumnsCollection[b].VisibilityHasChangedDuringBodyViewStateTracking=true};oboutGrid.prototype.getVisibleColumnsNumber=function(){for(var b=0,a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Visible==true)b++;return b};oboutGrid.prototype.getNextVisibleColumnIndex=function(b){for(var a=b+1;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Visible==true)return a;return-1};oboutGrid.prototype.getPreviousVisibleColumnIndex=function(b){for(var a=b-1;a>=0;a--)if(this.ColumnsCollection[a].Visible==true)return a;return-1};oboutGrid.prototype.persistColumnsVisibleState=function(){sNewColumnVisibleState="";for(var a=0;a<this.ColumnsCollection.length;a++){if(sNewColumnVisibleState!="")sNewColumnVisibleState+=",";sNewColumnVisibleState+=this.ColumnsCollection[a].RealVisible==true?1:0}this.ColumnsVisibleStateContainer.value=sNewColumnVisibleState};oboutGrid.prototype.manageColumnFooterVisibleState=function(c,b){if(this.hasFooter()!=null){var a=this.getColumnsFooterRow();a.childNodes[c].style.display=b;if(this.GridHeaderContainer!=null){a.parentNode.parentNode.style.width=this.GridHeaderContainer.firstChild.style.width;a.parentNode.parentNode.parentNode.style.width=this.GridHeaderContainer.firstChild.style.width}}};oboutGrid.prototype.showColumnFooter=function(a){this.manageColumnFooterVisibleState(a,"")};oboutGrid.prototype.hideColumnFooter=function(a){this.manageColumnFooterVisibleState(a,"none")};oboutGrid.prototype.stopEventPropagation=function(a){if(!a)a=window.event;if(!a)return false;a.cancelBubble=true;a.stopPropagation&&a.stopPropagation()};oboutGrid.prototype.stopAllEventsPropagation=function(b,c){var a=this;b.onmousedown=function(b){a.stopEventPropagation(b)};b.onmousemove=function(b){a.stopEventPropagation(b)};b.onmouseup=function(b){a.stopEventPropagation(b)};if(!c)b.onclick=function(b){a.stopEventPropagation(b)}};oboutGrid.prototype.cancelStopAllEventsPropagation=function(a){var b=this;a.onmousedown=function(){return true};a.onmousemove=function(){return true};a.onmouseup=function(){return true};a.onclick=function(){return true}};oboutGrid.prototype.detachAllEventHandlers=function(a){a.onmousedown=null;a.onmousemove=null;a.onmouseup=null;a.onclick=null};oboutGrid.prototype.loadFirstPage=function(){if(this.PageSelector.value>0){this.PageSelector.value=0;this.initiateCallback()}};oboutGrid.prototype.loadPreviousPage=function(){if(this.PageSelector.value>0){this.PageSelector.value=parseInt(this.PageSelector.value)-1;this.initiateCallback()}};oboutGrid.prototype.loadNextPage=function(){if(this.PageSelector.value<parseFloat(parseFloat(this.TotalRecords)/parseFloat(this.PageSize))-1){this.PageSelector.value=parseInt(this.PageSelector.value)+1;this.initiateCallback()}};oboutGrid.prototype.loadLastPage=function(){if(this.PageSelector.value!=Math.ceil(parseFloat(parseFloat(this.TotalRecords)/parseFloat(this.PageSize))-1)){this.PageSelector.value=Math.ceil(parseFloat(parseFloat(this.TotalRecords)/parseFloat(this.PageSize))-1);this.initiateCallback()}};oboutGrid.prototype.changePage=function(a){this.PageSelector.value=a;this.initiateCallback()};oboutGrid.prototype.jumpToPage=function(a){if(this.JumpToPageTextbox==null&&this.ElementsClientIds.ManualPagingTextboxID)this.JumpToPageTextbox=eval(this.ElementsClientIds.ManualPagingTextboxID);if(this.TopJumpToPageTextbox==null&&this.ElementsClientIds.TopManualPagingTextboxID)this.TopJumpToPageTextbox=eval(this.ElementsClientIds.TopManualPagingTextboxID);if(a!=2)iPageIndex=parseInt(this.JumpToPageTextbox.value());else iPageIndex=parseInt(this.TopJumpToPageTextbox.value());if(isNaN(iPageIndex)==true)return;iPageIndex=iPageIndex-1;if(iPageIndex<0)iPageIndex=0;this.changePage(iPageIndex)};oboutGrid.prototype.getCurrentPageIndex=function(){return this.PageSelector.value};oboutGrid.prototype.getTotalNumberOfRecords=function(){return this.TotalRecords};oboutGrid.prototype.getTotalNumberOfPages=function(){return Math.ceil(parseFloat(this.getTotalNumberOfRecords())/parseFloat(this.getPageSize()))};oboutGrid.prototype.setPageSize=function(a){if(this.PageSizeSelector)this.PageSizeSelector.value(a);else this.TopPageSizeSelector&&this.TopPageSizeSelector.value(a)};oboutGrid.prototype.getPageSize=function(){return this.PageSizeSelector?this.PageSizeSelector.value():this.TopPageSizeSelector?this.TopPageSizeSelector.value():this.PageSize};oboutGrid.prototype.sortHeaderColumn=function(a,b){if(!a)a=window.event;if(a.ctrlKey==false)var c=false;else var c=true;var d=this.getElementIndex(b)-this.getFirstColumnIndex();this.sortColumn(d,c,b)};oboutGrid.prototype.sortColumn=function(e,d,c){var b=this.ColumnsCollection[e];if(!b.AllowSorting)return;if(typeof d=="undefined")d=false;if(typeof c=="undefined")c=this.getHeaderRow().childNodes[e];for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!="")if(d==false&&this.ColumnsCollection[a].SortOrder!="None"&&a!=e){this.ColumnsCollection[a].SortOrder="None";this.ColumnsCollection[a].SortPriority=0;this.changeColumnSortImage(c.parentNode.childNodes[a],this.PlaceHolder.src,false)}if(b.SortOrder=="None")b.SortPriority=this.getColumnsMaxSortPriority()+1;if(b.SortOrder!="Asc"){b.SortOrder="Asc";this.changeColumnSortImage(c,this.AscSortingArrow.src,true)}else{b.SortOrder="Desc";this.changeColumnSortImage(c,this.DescSortingArrow.src,true)}this.initiateCallback()};oboutGrid.prototype.changeColumnSortImage=function(c,a){var b=this.getHeaderCellSortImage(c);b.src=a};oboutGrid.prototype.getColumnsMaxSortPriority=function(){for(var b=0,a=0;a<this.ColumnsCollection.length;a++)if(b<this.ColumnsCollection[a].SortPriority)b=this.ColumnsCollection[a].SortPriority;return b};oboutGrid.prototype.executeCommand=function(e,d,a){if(typeof a=="undefined"||a==false)var b=this.getRecordValues(e);else var b=this.getMultiRecordValues();if(this.CallbackMode==true)this.BackupViewState=this.ViewState;this.ViewState=null;if(b!=""){var c="ob_"+this.ID+"ExecuteCommand="+d+"&ob_"+this.ID+"CommandVariables="+b;this.initiateCallback(c)}};oboutGrid.prototype.getRecordValues=function(j){var f="",e=[],g=this.getBodyRow(j),c="",k=null,a="";if(g!=null){for(var i=this.ColumnsCollection.length,b=0;b<i;b++){var d=g.childNodes[b];if(this.ColumnsCollection[b].DataField!=""){if(d&&d.firstChild){var h=this.getBodyCellDataContainer(d);a=h.innerHTML;a=this.replaceBRsWithLineBreaks(a);c=this.CallbackMode==true?this.urlEncode(this.htmlDecode(a)):this.htmlDecode(a)}else{a=this.RecordTempValues[b];c=this.CallbackMode==true?this.urlEncode(a):a}e.push(this.ColumnsCollection[b].DataField+this.urlEncode(this.CommandNameValueSeparator+this.xmlCdataDecode(c)))}}f=e.join(this.CommandVariableSeparator)}return f};oboutGrid.prototype.getMultiRecordValues=function(){var c=[],e=[],d=[],b="";if(this.AllowMultiRecordAdding&&(this.RecordsInAddMode>0||this.TopRecordsInAddMode>0)){if(this.TopRecordsInAddMode>0)for(var a=0;a<this.TopRecordsInAddMode;a++)c.push(this.getRecordValues(a));if(this.RecordsInAddMode>0)for(var f=this.getBodyRowCount(),a=f-1;a>=f-this.RecordsInAddMode;a--)c.push(this.getRecordValues(a));b+=c.join(this.ArrayElementsSeparator)}else b+="NULL";b+=this.CommandsSeparator;if(this.AllowMultiRecordEditing&&this.RecordsTemporaryEdited.length>0){for(var a=0;a<this.RecordsTemporaryEdited.length;a++)e.push(this.getRecordValues(this.RecordsTemporaryEdited[a]));b+=e.join(this.ArrayElementsSeparator)}else b+="NULL";b+=this.CommandsSeparator;if(this.AllowMultiRecordDeleting&&this.RecordsTemporaryDeleted.length>0){for(var a=0;a<this.RecordsTemporaryDeleted.length;a++)d.push(this.getRecordValues(this.RecordsTemporaryDeleted[a]));b+=d.join(this.ArrayElementsSeparator)}else b+="NULL";return b};oboutGrid.prototype.getRecordValuesByRecord=function(e){for(var b={},c=this.getFirstColumnIndex(),a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!=""){var d=this.getBodyCellDataContainer(e.childNodes[c+a]);sColumnValue=d.innerHTML;b[this.ColumnsCollection[a].DataField]=sColumnValue!=""?this.xmlCdataDecode(sColumnValue).replace(/\r\n/g," "):""}return b};oboutGrid.prototype.getRowByRecord=function(a){return this.GridBodyContainer!=null&&this.getBody().childNodes[a]?this.getBody().childNodes[a]:null};oboutGrid.prototype.getRowIndexByRow=function(c){for(var b=this.getBody(),a=0;a<b.childNodes.length;a++)if(b.childNodes[a]==c)return a;return-1};oboutGrid.prototype.showMultiRecordsSaveCancelButtons=function(e){var b=this.MultiRecordsSaveCancelButtonsContainer.previousSibling,d=false,c=false;if(b.previousSibling==null&&b.parentNode.previousSibling.childNodes.length==0){b=this.MultiRecordsSaveCancelButtonsContainer.nextSibling;d=true}if(this.TopMultiRecordsSaveCancelButtonsContainer){var a=this.TopMultiRecordsSaveCancelButtonsContainer.previousSibling;if(a.previousSibling==null&&a.parentNode.previousSibling.childNodes.length==0){a=this.TopMultiRecordsSaveCancelButtonsContainer.nextSibling;c=true}}if(e==true){this.MultiRecordsSaveCancelButtonsContainer.style.display="";if(!d)b.style.display="";else{b.style.visibility="visible";if(b.previousSibling&&b.previousSibling.previousSibling){b.previousSibling.previousSibling.style.visibility="hidden";b.previousSibling.previousSibling.style.display=""}}if(this.TopMultiRecordsSaveCancelButtonsContainer){this.TopMultiRecordsSaveCancelButtonsContainer.style.display="";if(!c)a.style.display="";else{a.style.visibility="visible";if(a.previousSibling&&a.previousSibling.previousSibling){a.previousSibling.previousSibling.style.visibility="hidden";a.previousSibling.previousSibling.style.display=""}}}}else{this.MultiRecordsSaveCancelButtonsContainer.style.display="none";if(!d)b.style.display="none";else{b.style.visibility="hidden";if(b.previousSibling&&b.previousSibling.previousSibling)b.previousSibling.previousSibling.style.display="none"}if(this.TopMultiRecordsSaveCancelButtonsContainer){this.TopMultiRecordsSaveCancelButtonsContainer.style.display="none";if(!c)a.style.display="none";else{a.style.visibility="hidden";if(a.previousSibling&&a.previousSibling.previousSibling)a.previousSibling.previousSibling.style.display="none"}}}};oboutGrid.prototype.addRecord=function(a){this._previousNewRecordPosition=this.NewRecordPosition!=3?this.NewRecordPosition:1;if(typeof a!="undefined")this.NewRecordPosition=a;if(this.bCallbackInitiated||!this.OnLoadExecuted)return false;if(this.OnBeforeClientAdd!=null){var b=this.getRecordAsObject();if(this.raiseClientEvent(this.OnBeforeClientAdd,b)==false)return}this.AllowMultiRecordAdding==true&&this.NewRecordLine!=null&&this.insertTemporaryRecord(false,true);this._previousNewRecordPosition=null;if(this.AllowMultiRecordAdding==true)this.GridBodyViewStateIsSaved==false&&this.saveGridBodyViewState();if(this.RecordInEditMode!=null){this.ModifyTemporaryRecordForInsert==true&&this.updateTemporaryRecord();var c=true;if(this.AllowMultiRecordEditing&&this.isTemporaryEditedRecord(this.RecordInEditMode)==false)c=this.checkRecordDataModified(this.RecordInEditMode);var d=this.cancelEdit(this.RecordInEditMode,!c);if(d==false)return;if(this.AllowMultiRecordAdding==true)this.GridBodyViewStateIsSaved==false&&this.saveGridBodyViewState()}if(this.NewRecordPosition==1)this.RecordsInAddMode++;else this.TopRecordsInAddMode++;this.NewRecordLine=this.addBodyRow(this.RowEditTemplateId=="",this.NewRecordPosition==1?null:0,true);this.loadEditTemplates(this.NewRecordPosition==1?this.getBodyRowCount()-1:0,"ADD");this.ScrollHeight&&this.scrollDownBody();this.renderAddButtons();this.AllowMultiRecordAdding==true&&this.showMultiRecordsSaveCancelButtons(true);if(this.OnClientAdd!=null){var b=this.getRecordAsObject();this.raiseClientEvent(this.OnClientAdd,b)}};oboutGrid.prototype.backupAddRecordContainer=function(a,c){if(this[a])if(this.AllowMultiRecordAdding==false){this[c]=document.createElement("DIV");while(this[a].firstChild){var b=null;if(!(this.isIE&&this.NewRecord_TemplateId==""))b=this[a].firstChild;else{b=this[a].firstChild.cloneNode(true);this[a].removeChild(this[a].firstChild)}this[c].appendChild(b)}}};oboutGrid.prototype.renderSaveCancelLinks=function(a){if(this[a]){var b=this,e=document.createTextNode(" | "),d=this.renderFooterLink(function(){b.insertRecord();return false},this.Localization_SaveLink),c=this.renderFooterLink(function(){b.cancelNewRecord();return false},this.Localization_CancelLink);this[a].appendChild(d);this[a].appendChild(e);this[a].appendChild(c)}};oboutGrid.prototype.renderAddButtons=function(){if(this.AddRecordButtonsCreated==true)return;this.backupAddRecordContainer("AddRecordButtonContainer","AddRecordContainerBackup");this.backupAddRecordContainer("TopAddRecordButtonContainer","TopAddRecordContainerBackup");if(this.NewRecord_EditTemplateId==""){if(this.AllowMultiRecordAdding==false){this.renderSaveCancelLinks("AddRecordButtonContainer");this.renderSaveCancelLinks("TopAddRecordButtonContainer")}}else if(this.AllowMultiRecordAdding==false){if(this.NewRecord_EditTemplateContainer){var a=this.NewRecord_EditTemplateContainer.removeChild(this.NewRecord_EditTemplateContainer.firstChild);this.AddRecordButtonContainer.appendChild(a)}if(this.TopNewRecord_EditTemplateContainer){var a=this.TopNewRecord_EditTemplateContainer.removeChild(this.TopNewRecord_EditTemplateContainer.firstChild);this.TopAddRecordButtonContainer.appendChild(a)}}if(this.AllowMultiRecordAdding==true)this.AddRecordButtonsCreated=true};oboutGrid.prototype.renderFooterLink=function(a,b){return this.renderLink(this.CSSActionLinkFooter,a,b)};oboutGrid.prototype.renderBodyLink=function(a,b){return this.renderLink(this.CSSActionLink,a,b)};oboutGrid.prototype.renderLink=function(c,b,d){var a=document.createElement("A");a.className=c;a.href="javascript: //";if(typeof b=="function")a.onclick=b;else a.setAttribute("onclick",b);a.innerHTML=d;return a};oboutGrid.prototype.getCellData=function(a){return a.firstChild.innerHTML};oboutGrid.prototype.populateAddEditControlsWithValues=function(){for(var b={},c="",a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!="")if(this.RecordInEditMode!=null){if(this.AllowMultiRecordEditing==false&&this.Rows[this.RecordInEditMode]!=null&&this.Rows[this.RecordInEditMode].Cells[a]!=null)b[this.ColumnsCollection[a].DataField]=this.Rows[this.RecordInEditMode].Cells[a].Value;else b[this.ColumnsCollection[a].DataField]=this.ArrEditRowTempValues[a];c="edit"}else{b[this.ColumnsCollection[a].DataField]="";c="add"}if(this.OnClientPopulateControls!=null){var d=this.raiseClientEvent(this.OnClientPopulateControls,b,c);if(d!=null)b=d}return b};oboutGrid.prototype.populateControls=function(d){for(var b=false,a=0;a<this.ColumnsCollection.length;a++){var e=false;if(this.ColumnsCollection[a].DataField!=""&&!this.ColumnsCollection[a].ReadOnly&&this.ColumnsCollection[a].ControlID&&this.ColumnsCollection[a].ControlPropertyName){var c=this.replaceBRsWithLineBreaks(d[this.ColumnsCollection[a].DataField]);b=this.setValueOfTemplateControl(this.ColumnsCollection[a].ControlID,this.ColumnsCollection[a].ControlPropertyName,c,!b&&this.ColumnsCollection[a].Visible)}}};oboutGrid.prototype.updateTemporaryRecord=function(b){if(this.RecordInEditMode!=null){var a=true;if(this.AllowMultiRecordEditing==true&&this.isTemporaryEditedRecord(this.RecordInEditMode)==false)a=this.checkRecordDataModified(this.RecordInEditMode);var c=this.cancelEdit(this.RecordInEditMode,!a,b);if(c==false)return}};oboutGrid.prototype.insertTemporaryRecord=function(b,c){if(this._previousNewRecordPosition==null)this._previousNewRecordPosition=this.NewRecordPosition;if(this.NewRecordLine!=null)if(this.RowEditTemplateId==""||!c)var a=this._previousNewRecordPosition==1?this.getBodyRowCount()-1:0;else{var a=this._previousNewRecordPosition==1?this.getBodyRowCount()-2:0,d=this._previousNewRecordPosition!=1,e=this.addBodyRow(true,a,d);if(this.NewRecordPosition==1)a++}else var a=this.RecordInEditMode;this.updateRowValues(a);this.AllowMultiRecordAdding==true&&this.applyCssClassToBodyRowCells(a,this.CSSCellTemporaryAdded);this.reloadTemplatesContainer(a,true,"ADD");b==true&&this.restoreNewRecordTemplate();this.NewRecordLine=null};oboutGrid.prototype.insertRecord=function(){var a=this.NewRecordPosition==1?this.getBodyRowCount()-1:0;if(this.OnBeforeClientInsert!=null){var c=this.getRecordValuesAsObject(a,true);if(this.raiseClientEvent(this.OnBeforeClientInsert,c)==false)return}if(this.EnableTypeValidation==true)if(this.validateColumnTypes(a)==false)return;this.insertTemporaryRecord(true,this.RowEditTemplateId!="");var b=false;if(this.AllowMultiRecordAdding==true)b=true;this.executeCommand(a,"INSERT",b);this.RecordsInAddMode=0;this.TopRecordsInAddMode=0};oboutGrid.prototype.cancelNewRecord=function(){var a=this.NewRecordPosition==1?this.getBodyRowCount()-1:0;if(this.OnBeforeClientCancelAdd!=null){var b=this.getRecordValuesAsObject(a,true);if(this.raiseClientEvent(this.OnBeforeClientCancelAdd,b)==false)return false}var c=this;this.AllowMultiRecordAdding==false&&this.restoreNewRecordTemplate();this.reloadTemplatesContainer(a,false,"ADD");if(this.NewRecordLine!=null){this.RowEditTemplateId==""&&this.removeBodyRow(a);this.NewRecordLine=null}if(this.NewRecordPosition==1)this.RecordsInAddMode--;else this.TopRecordsInAddMode--;if(this.OnClientCancelAdd!=null){var b=this.getRecordValuesAsObject(a,true);this.raiseClientEvent(this.OnClientCancelAdd,b)}this.AddRecordButtonsCreated=false;if(this.NewRecordPosition!=1)if(this.GridBodyContainer.firstChild.firstChild.offsetHeight!=this.GridBodyContainer.firstChild.firstChild.childNodes[1].offsetHeight)this.GridBodyContainer.firstChild.firstChild.style.height=this.GridBodyContainer.firstChild.firstChild.childNodes[1].offsetHeight+"px"};oboutGrid.prototype.restoreNewRecordTemplate=function(){if(this.NewRecord_EditTemplateId==""){if(this.AddRecordButtonContainer){while(this.AddRecordButtonContainer.firstChild)this.AddRecordButtonContainer.removeChild(this.AddRecordButtonContainer.firstChild);while(this.AddRecordContainerBackup.firstChild)this.AddRecordButtonContainer.appendChild(this.AddRecordContainerBackup.firstChild)}if(this.TopAddRecordButtonContainer){while(this.TopAddRecordButtonContainer.firstChild)this.TopAddRecordButtonContainer.removeChild(this.TopAddRecordButtonContainer.firstChild);while(this.TopAddRecordContainerBackup.firstChild)this.TopAddRecordButtonContainer.appendChild(this.TopAddRecordContainerBackup.firstChild)}}else if(this.AllowMultiRecordAdding==false){if(this.NewRecord_EditTemplateContainer){this.NewRecord_EditTemplateContainer.appendChild(this.AddRecordButtonContainer.firstChild);while(this.AddRecordContainerBackup.firstChild)this.AddRecordButtonContainer.appendChild(this.AddRecordContainerBackup.firstChild)}if(this.TopNewRecord_EditTemplateContainer){this.TopNewRecord_EditTemplateContainer.appendChild(this.TopAddRecordButtonContainer.firstChild);while(this.TopAddRecordContainerBackup.firstChild)this.TopAddRecordButtonContainer.appendChild(this.TopAddRecordContainerBackup.firstChild)}}};oboutGrid.prototype.editRecord=function(f){if(this.bCallbackInitiated||!this.OnLoadExecuted)return false;if(typeof f=="object")var b=this.getRecordIndexByObject(f);else var b=f;if(this.OnBeforeClientEdit!=null){var g=this.getRecordValuesAsObject(b,false);if(this.raiseClientEvent(this.OnBeforeClientEdit,g)==false)return}if(this.AllowMultiRecordEditing==true)this.GridBodyViewStateIsSaved==false&&this.saveGridBodyViewState();if(this.NewRecordLine!=null)if(this.AllowMultiRecordAdding==false){var h=this.cancelNewRecord();if(h==false)return}else this.insertTemporaryRecord(false,true);if(this.RecordInEditMode!=null){if(this.RowEditTemplateId!=""&&b>this.RecordInEditMode)b--;var i=true;if(this.AllowMultiRecordEditing&&this.isTemporaryEditedRecord(this.RecordInEditMode)==false)i=this.checkRecordDataModified(this.RecordInEditMode);var h=this.cancelEdit(this.RecordInEditMode,!i);if(h==false)return;if(this.AllowMultiRecordEditing==true)this.GridBodyViewStateIsSaved==false&&this.saveGridBodyViewState()}var e=this.getBodyRow(b);if(e==null)return;this.RecordInEditMode=b;this.RecordInEditModePreviousValues=[];this.ArrEditRowTempValues=[];for(var a=0;a<this.ColumnsCollection.length;a++){var c=this.getBodyCellInnerContainer(e.childNodes[a]);if(this.AllowMultiRecordAdding==true||this.AllowMultiRecordEditing==true){var j=this.getBodyCellDataContainer(e.childNodes[a]);this.ArrEditRowTempValues[a]=j.innerHTML}if(this.ColumnsCollection[a].ReadOnly==false&&(this.RowEditTemplateId==""||this.ColumnsCollection[a].AllowEdit==true)){var d=document.createElement("DIV");if(!(this.isIE&&this.ColumnsCollection[a].AllowEdit&&this.ColumnsCollection[a].TemplateId==""))this.moveChildren(c,d);else{d.innerHTML=c.innerHTML;this.clearChildren(c)}this.RecordInEditModePreviousValues.push(d)}else this.RecordInEditModePreviousValues.push(null)}this.loadEditTemplates(this.RecordInEditMode,"EDIT");this.AllowMultiRecordEditing==true&&this.showMultiRecordsSaveCancelButtons(true);if(this.OnClientEdit!=null){var g=this.getRecordValuesAsObject(b,true);this.raiseClientEvent(this.OnClientEdit,g)}};oboutGrid.prototype.checkRecordDataModified=function(d){d-=this.TopRecordsInAddMode;var e=this.getRecordValuesAsObject(d,true);if(this.Rows[d]){for(var c=0;c<this.ColumnsCollection.length;c++)if(this.ColumnsCollection[c].DataField!=""){var b=this.Rows[d].Cells[c].Value,a=e[this.ColumnsCollection[c].DataField];if(b=="True"||b=="False")b=b.toLowerCase();if(a=="True"||a=="False")a=a.toLowerCase();if(b.toString()!=a.toString())return true}return false}else return true};oboutGrid.prototype.loadEditTemplates=function(i,e){var A=this,s=this.getBodyRow(i);if(this.RowEditTemplateId==""||e=="EDIT"){var z=0,c="",l=false;if(this.RowEditTemplateId=="")var x=this.populateAddEditControlsWithValues();for(var a=0;a<this.ColumnsCollection.length;a++){var w=s.childNodes[a],b=this.getBodyCellInnerContainer(w);if(this.ColumnsCollection[a].DataField!=""){if(this.ColumnsCollection[a].ReadOnly==false&&this.RowEditTemplateId==""){var d=this.getTemplateIndexFromDivById(this.EditTemplateContainer,this.ColumnsCollection[a].EditTemplateId);c=x[this.ColumnsCollection[a].DataField];this.AllowRecordSelection==true&&this.stopAllEventsPropagation(b);b.appendChild(this.EditTemplateContainer.childNodes[d].firstChild);this.ColumnsCollection[a].ControlID=this.EditTemplateContainer.childNodes[d].childNodes[0].innerHTML;this.ColumnsCollection[a].ControlPropertyName=this.EditTemplateContainer.childNodes[d].childNodes[1].innerHTML;if(this.EditTemplateContainer.childNodes[d].childNodes[2].innerHTML=="true")this.ColumnsCollection[a].UseDoubleQuotes=true;else this.ColumnsCollection[a].UseDoubleQuotes=false;if(this.ColumnsCollection[a].ControlID&&this.ColumnsCollection[a].ControlPropertyName){if(this.ColumnsCollection[a].UseDoubleQuotes==false)if(c=="True"||c=="False")c=c.toLowerCase();var y=this.ColumnsCollection[a].ControlID.replace(/"/g,'\\"'),v=this.replaceBRsWithLineBreaks(this.xmlCdataDecode(c)),t=this.ColumnsCollection[a].ControlPropertyName;l=this.setValueOfTemplateControl(y,t,v,!l&&this.ColumnsCollection[a].Visible)}z++}}else{var j=false,k=false,f=false;if(this.AllowMultiRecordAdding==false&&this.AllowMultiRecordEditing==false)f=true;else if(this.isNewTempRecord(i)==true)k=true;else if(this.AllowMultiRecordEditing==true)j=true;else f=true;if(f==true)if(this.ColumnsCollection[a].EditTemplateId==""){var q="",o="",u="&#160;|&#160;";if(this.ColumnsCollection[a].AllowEdit==true)if(e=="EDIT"){var p,n;p='href="javascript: //" onclick="'+this.ID+".updateRecord("+this.RecordInEditMode+');return false;"';n='href="javascript: //" onclick="'+this.ID+".cancelEdit("+this.RecordInEditMode+', true);return false;"';q='<a class="'+this.CSSActionLink+'" '+p+">"+this.Localization_UpdateLink+"</a>";o='<a class="'+this.CSSActionLink+'" '+n+">"+this.Localization_CancelLink+"</a>";b.innerHTML=q+u+o}else b.innerHTML="&#160;"}else if(e=="EDIT"||this.ColumnsCollection[a].AllowEdit==false){var d=this.getTemplateIndexFromDivById(this.EditTemplateContainer,this.ColumnsCollection[a].EditTemplateId);b.appendChild(this.EditTemplateContainer.childNodes[d].firstChild)}else b.innerHTML="&#160;";else if(j==true){this.clearChildren(b);if(this.ColumnsCollection[a].CancelTemporaryEditedRecord_TemplateId==""){var m=this.renderBodyLink(this.ID+".cancel_edit(this, true); return false; ",this.Localization_CancelLink);b.appendChild(m);if(this.ColumnsCollection[a].AllowDelete){var g=this.renderBodyLink(this.ID+".delete_record(this); return false; ",this.Localization_DeleteLink),r=document.createTextNode(" | ");b.appendChild(r);b.appendChild(g)}}else{var h=this.getColumnMultiRecordTemplate(a,"CancelTemporaryEditedRecord");b.innerHTML=h.innerHTML}}else if(k==true){this.clearChildren(b);if(e=="ADD"){if(this.AllowMultiRecordAdding==true&&this.ColumnsCollection[a].DataField==""&&this.ColumnsCollection[a].AllowEdit==true)if(this.ColumnsCollection[a].RemoveTemporaryAddedRecord_TemplateId==""){var g=this.renderBodyLink(this.ID+'.removeTemporaryRecord(this, "ADD"); return false; ',this.Localization_RemoveLink);b.appendChild(g)}else{var h=this.getColumnMultiRecordTemplate(a,"RemoveTemporaryAddedRecord");b.innerHTML=h.innerHTML}}else if(this.ColumnsCollection[a].CancelTemporaryAddedRecord_TemplateId==""){var m=this.renderBodyLink(this.ID+".cancel_edit(this, true); return false; ",this.Localization_CancelLink),g=this.renderBodyLink(this.ID+'.removeTemporaryRecord(this, "EDIT"); return false; ',this.Localization_RemoveLink),r=document.createTextNode(" | ");b.appendChild(m);b.appendChild(r);b.appendChild(g)}else{var h=this.getColumnMultiRecordTemplate(a,"CancelTemporaryAddedRecord");b.innerHTML=h.innerHTML}}}}}if(this.RowEditTemplateId!=""){if(e=="EDIT")this.loadRowEditTemplate(i,null);else this.loadRowEditTemplate(null,s);this.populateRowTemplateControlsWithValues()}};oboutGrid.prototype.loadRowEditTemplate=function(b,a){if(a==null)a=this.addBodyRow(false,b);a.firstChild.appendChild(this.RowEditTemplateContainer.firstChild)};oboutGrid.prototype.populateRowTemplateControlsWithValues=function(){for(var e=this.populateAddEditControlsWithValues(),a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!=""&&this.ColumnsCollection[a].RowEditTemplateControlID!=null&&this.ColumnsCollection[a].RowEditTemplateControlID!=""){var b=e[this.ColumnsCollection[a].DataField];if(this.ColumnsCollection[a].RowEditTemplateUseQuotes==false)if(b=="True"||b=="False")b=b.toLowerCase();var f=this.ColumnsCollection[a].RowEditTemplateControlID.replace(/"/g,'\\"'),d=this.replaceBRsWithLineBreaks(this.xmlCdataDecode(b)),c=this.ColumnsCollection[a].RowEditTemplateControlPropertyName;this.setValueOfTemplateControl(f,c,d,false)}};oboutGrid.prototype.getTemplateIndexFromDivById=function(b,c){for(var a=0;a<b.childNodes.length;a++)if(b.childNodes[a].id==c)return a;return-1};oboutGrid.prototype.updateRecord=function(a){if(this.bCallbackInitiated)return false;if(this.OnBeforeClientUpdate!=null){var b=this.getRecordValuesAsObject(a,true);if(this.raiseClientEvent(this.OnBeforeClientUpdate,b)==false)return}if(this.EnableTypeValidation==true)if(this.validateColumnTypes(a)==false)return;this.updateRowValues(a);this.reloadTemplatesContainer(a,true,"EDIT");this.AllowRecordSelection==true;this.RecordInEditModeBackup=this.RecordInEditMode;this.RecordInEditMode=null;this.RecordInEditModePreviousValues=null;this.executeCommand(a,"UPDATE")};oboutGrid.prototype.updateRowValues=function(e){var d=this.getBodyRow(e);if(d==null)return;this.RecordTempValues=[];for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!=""&&this.ColumnsCollection[a].ReadOnly==false){var c=null,b=null;if(this.RowEditTemplateId==""){if(this.ColumnsCollection[a].ControlID&&this.ColumnsCollection[a].ControlPropertyName){c=this.ColumnsCollection[a].ControlID;b=this.ColumnsCollection[a].ControlPropertyName}}else if(this.ColumnsCollection[a].RowEditTemplateControlID&&this.ColumnsCollection[a].RowEditTemplateControlPropertyName){c=this.ColumnsCollection[a].RowEditTemplateControlID;b=this.ColumnsCollection[a].RowEditTemplateControlPropertyName}if(c&&b){var f=this.getValueFromTemplateControl(c,b);this.RecordTempValues[a]=f;if(d.childNodes[a]&&this.hasBodyCellDataContainer(d.childNodes[a])){var g=this.getBodyCellDataContainer(d.childNodes[a]);g.innerHTML=this.replaceLineBreaksWithBRs(this.htmlEncode(f))}}}else if(this.AllowMultiRecordEditing==true&&this.RecordInEditMode!=null&&this.ColumnsCollection[a].ReadOnly==true&&this.ColumnsCollection[a].DataField!="")if(this.Rows[e]!=null)this.RecordTempValues[a]=this.Rows[e].Cells[a].Value};oboutGrid.prototype.getTemplateControl=function(b){var a=oboutUtils.getById(b);if(a==null)a=eval(b);return a};oboutGrid.prototype.getValueFromTemplateControl=function(c,b){var a=this.getTemplateControl(c);return a?typeof a[b]!="function"?a[b]:a[b]():""};oboutGrid.prototype.setValueOfTemplateControl=function(e,c,a,d){var b=this.getTemplateControl(e);if(a=="true"||a=="false")a=a=="true"?true:false;if(b){if(typeof b[c]!="function")b[c]=a;else{if(c=="checked"&&(a==""||a==null))a=false;b[c](a)}if(d&&this.ScrollWidth=="0px"){typeof b.select=="function"&&b.select();if(typeof b.focus=="function"){b.focus();return true}}}return!d};oboutGrid.prototype.restorePreviousValues=function(d){for(var a=0;a<this.ColumnsCollection.length;a++){var c=d.childNodes[a],b=this.getBodyCellInnerContainer(c);if(this.RecordInEditModePreviousValues&&this.RecordInEditModePreviousValues[a]!=null){this.clearChildren(b);this.moveChildren(this.RecordInEditModePreviousValues[a],b)}}};oboutGrid.prototype.getWidth=function(b){var a=parseInt(this.getStyle(b,"width"));if(isNaN(a))a=b.offsetWidth;return a};oboutGrid.prototype.cancelEdit=function(a,b,f){if(this.OnBeforeClientCancelEdit!=null){var c=this.getRecordValuesAsObject(a,true);if(this.raiseClientEvent(this.OnBeforeClientCancelEdit,c)==false)return false}var d=this.getBodyRow(a);if(d==null)return;if(this.AllowMultiRecordEditing||this.AllowMultiRecordAdding&&this.isNewTempRecord(a)){var e=this.AllowMultiRecordAdding&&this.isNewTempRecord(a);this.updateRowValues(a);if(!b){this.markRecordAsEdited(a);this.applyCssClassToBodyRowCells(a,e==false?this.CSSCellTemporaryEdited:this.CSSCellTemporaryAdded)}}this.reloadTemplatesContainer(a,(this.AllowMultiRecordEditing&&this.isTemporaryEditedRecord(a)||this.AllowMultiRecordAdding&&this.isNewTempRecord(a))&&!b,"EDIT");(this.AllowMultiRecordEditing==false&&!(this.AllowMultiRecordAdding&&this.isNewTempRecord(a))||b==true)&&this.restorePreviousValues(d,a);this.RecordInEditModePreviousValues=null;this.RecordInEditMode=null;if(this.OnClientCancelEdit!=null){var c=this.getRecordValuesAsObject(a,true);this.raiseClientEvent(this.OnClientCancelEdit,c)}this.AllowMultiRecordEditing==true&&!f&&this.attemptToHideSaveCancelButtons();return true};oboutGrid.prototype.getRecordIndexByElementInsideCell=function(a){while(a!=null&&a.nodeName!="TR"&&this.isBodyRecord(a)==false)a=a.parentNode;var b=this.getElementIndex(a);if(this.AllowMultiRecordEditing&&this.RowEditTemplateId!=""&&this.RecordInEditMode!=null&&this.RecordInEditMode<b)b--;return b};oboutGrid.prototype.removeTemporaryRecord=function(d,c){var a=this.getRecordIndexByElementInsideCell(d),b=true;if(c!=null)if(c=="EDIT"){if(this.RecordInEditMode!=null&&this.RecordInEditMode==a){this.cancelEdit(a);this.ModifyTemporaryRecordForInsert=false}}else{this.cancelNewRecord();this.ModifyTemporaryRecordForInsert=false;b=false}if(b==true){if(a<this.TopRecordsInAddMode)this.TopRecordsInAddMode--;else this.RecordsInAddMode--;this.removeBodyRow(a)}if(this.RecordInEditMode!=null&&a<this.RecordInEditMode)this.RecordInEditMode--;this.attemptToHideSaveCancelButtons()};oboutGrid.prototype.modifyTemporaryRecord=function(b){var a=this.getRecordIndexByElementInsideCell(b);this.NewRecordLine!=null&&this.insertTemporaryRecord(false,true);this.RecordInEditMode!=null&&this.updateTemporaryRecord();this.ModifyTemporaryRecordForInsert=true;this.editRecord(a)};oboutGrid.prototype.reloadTemplatesContainer=function(k,c,d){var h=this.getBodyRow(k);if(this.RowEditTemplateId==""||d=="EDIT"||d=="ADD"&&this.AllowMultiRecordAdding==false&&c||this.AllowMultiRecordAdding&&c)for(var a=0;a<this.ColumnsCollection.length;a++){var m=h.childNodes[a],b=this.getBodyCellInnerContainer(m);this.AllowRecordSelection==true&&this.cancelStopAllEventsPropagation(b);if(this.ColumnsCollection[a].ReadOnly==false&&(this.RowEditTemplateId==""||c||this.ColumnsCollection[a].EditTemplateId&&this.ColumnsCollection[a].AllowEdit)){if(this.ColumnsCollection[a].EditTemplateId&&(this.ColumnsCollection[a].AllowEdit==false||d!="ADD")){var l=this.getTemplateIndexFromDivById(this.EditTemplateContainer,this.ColumnsCollection[a].EditTemplateId),i=this.EditTemplateContainer.childNodes[l];i.insertBefore(b.firstChild,i.firstChild)}else this.clearChildren(b);if(c&&this.RecordTempValues&&this.RecordTempValues[a]!=null)b.innerHTML=this.replaceLineBreaksWithBRs(this.htmlEncode(this.RecordTempValues[a]))}if(c&&this.ColumnsCollection[a].AllowEdit){var q=this,e,f=false;if(this.AllowMultiRecordAdding&&this.isNewTempRecord(k))if(this.ColumnsCollection[a].ModifyTemporaryAddedRecord_TemplateId==""){var o=this.renderBodyLink(this.ID+".modifyTemporaryRecord(this); return false; ",this.Localization_ModifyLink),p=this.renderBodyLink(this.ID+'.removeTemporaryRecord(this, "EDIT"); return false; ',this.Localization_RemoveLink);f=true;e=true}else{var j=this.getColumnMultiRecordTemplate(a,"ModifyTemporaryAddedRecord");b.innerHTML=j.innerHTML}else if(this.AllowMultiRecordEditing)if(this.ColumnsCollection[a].ModifyTemporaryEditedRecord_TemplateId==""){var o=this.renderBodyLink(this.ID+".modifyTemporaryRecord(this); return false;",this.Localization_ModifyLink);if(this.ColumnsCollection[a].AllowDelete){var p=this.renderBodyLink(this.ID+".delete_record(this); return false; ",this.Localization_DeleteLink);e=true}else e=false;f=true}else{var j=this.getColumnMultiRecordTemplate(a,"ModifyTemporaryEditedRecord");b.innerHTML=j.innerHTML}if(f){b.appendChild(o);if(e){var n=document.createTextNode(" | ");b.appendChild(n);b.appendChild(p)}}}}if(this.RowEditTemplateId){var g=d=="EDIT"||d=="ADD"&&this.AllowMultiRecordAdding==false&&c||this.AllowMultiRecordAdding&&c?h.nextSibling:h;this.RowEditTemplateContainer.appendChild(g.firstChild.firstChild);g.parentNode.removeChild(g)}};oboutGrid.prototype.getRecordIndexByObject=function(a){var b=null;while(a!=null){if(a.nodeName=="TD"&&a.className.toString().indexOf("ob_gC")!=-1){b=a;break}a=a.parentNode}return this.getElementIndex(a.parentNode)};oboutGrid.prototype.getElementIndex=function(a){var b=0;while(a.previousSibling!=null){a=a.previousSibling;b++}return b};oboutGrid.prototype.edit_record=function(a){if(typeof a=="object")var b=this.getRecordIndexByObject(a);else var b=a;b!=-1&&this.editRecord(b)};oboutGrid.prototype.update_record=function(a){if(a!=null)if(typeof a=="object")var b=this.getRecordIndexByObject(a);else var b=a;else if(this.RowEditTemplateId!="")var b=this.RecordInEditMode;b!=-1&&this.updateRecord(b)};oboutGrid.prototype.cancel_edit=function(a,c){if(a!=null)if(typeof a=="object")var b=this.getRecordIndexByObject(a);else var b=a;else if(this.RowEditTemplateId!="")var b=this.RecordInEditMode;b!=-1&&this.cancelEdit(b,c)};oboutGrid.prototype.manageConfirmationKeyPress=function(){var a=-1,b=false;if(this.LastHighlightedRecord!=null)a=this.getElementIndex(this.LastHighlightedRecord);else if(this.RecordInEditMode>0)a=this.RecordInEditMode;else if(this.RecordsInAddMode>0||this.TopRecordsInAddMode>0){a=this.getBodyRowCount()-1;b=true}if(a!=-1)if(b||this.NewRecordLine&&a==this.getElementIndex(this.NewRecordLine))this.insertRecord();else if(this.RecordInEditMode!=a)this.editRecord(a);else this.updateRecord(a)};oboutGrid.prototype.manageCancelKeyPress=function(){var a=-1,b=false;if(this.LastHighlightedRecord!=null)a=this.getElementIndex(this.LastHighlightedRecord);else if(this.RecordInEditMode>0)a=this.RecordInEditMode;else if(this.RecordsInAddMode>0||this.TopRecordsInAddMode>0){a=this.getBodyRowCount()-1;b=true}if(a!=-1)if(this.RecordInEditMode==a)this.cancelEdit(a);else if(this.NewRecordLine!=null&&a==this.getElementIndex(this.NewRecordLine)){this.cancelNewRecord();this.LastHighlightedRecord=null}else if(this.CallbackMode==false)if(parseInt(this.PageSize)+1==this.LastHighlightedRecord.parentNode.childNodes.length&&this.getElementIndex(this.LastHighlightedRecord)==this.PageSize){this.cancelNewRecord();this.LastHighlightedRecord=null}};oboutGrid.prototype.executeInsert=function(a){this.executeCommandUsingProvidedObject("INSERT",a)};oboutGrid.prototype.executeUpdate=function(a){this.executeCommandUsingProvidedObject("UPDATE",a)};oboutGrid.prototype.executeDelete=function(a){this.executeCommandUsingProvidedObject("DELETE",a)};oboutGrid.prototype.executeCommandUsingProvidedObject=function(c,d){var a=this.getValuesFromProvidedObject(d);if(a!=""){var b="ob_"+this.ID+"ExecuteCommand="+c+"&ob_"+this.ID+"CommandVariables="+a;this.initiateCallback(b)}};oboutGrid.prototype.getValuesFromProvidedObject=function(b){var a=[];for(var c in b)a.push(c+this.urlEncode(this.CommandNameValueSeparator+this.urlEncode(b[c])));var d=a.join(this.CommandVariableSeparator);return d};oboutGrid.prototype.save=function(){if(this.RecordInEditMode!=null)this.update_record();else this.insertRecord()};oboutGrid.prototype.cancel=function(){if(this.RecordInEditMode!=null)this.cancel_edit();else this.cancelNewRecord()};oboutGrid.prototype.deleteRow=function(b){if(this.bCallbackInitiated||!this.OnLoadExecuted)return false;if(typeof b=="object")var a=this.getRecordIndexByObject(b);else var a=b;if(this.AllowMultiRecordDeleting==false){if(this.OnBeforeClientDelete!=null){var c=this.getRecordValuesAsObject(a,false);if(this.raiseClientEvent(this.OnBeforeClientDelete,c)==false)return}this.AllowRecordSelection==true;this.executeCommand(a,"DELETE")}else{this.GridBodyViewStateIsSaved==false&&this.saveGridBodyViewState();this.deleteTemporaryRecord(a);this.showMultiRecordsSaveCancelButtons(true)}};oboutGrid.prototype.delete_record=function(a){if(typeof a=="object")var b=this.getRecordIndexByObject(a);else var b=a;b!=-1&&this.deleteRow(b)};oboutGrid.prototype.deleteTemporaryRecord=function(b){this.RecordInEditMode!=null&&this.RecordInEditMode==b&&this.updateTemporaryRecord(true);for(var f=this.getBodyRow(b),i=this,e=0,a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].AllowDelete==true){var c=this.getBodyCellInnerContainer(f.childNodes[e+a]),d=c.cloneNode(false);c.parentNode.appendChild(d);this.TemporaryDeletedRecords[b]=c.parentNode.removeChild(c);if(this.ColumnsCollection[a].UndeleteTemporaryDeletedRecord_TemplateId==""){var g=this.renderBodyLink(this.ID+".undeleteTemporaryRecord("+b+"); return false; ",this.Localization_UndeleteLink);d.appendChild(g)}else{var h=this.getColumnMultiRecordTemplate(a,"UndeleteTemporaryDeletedRecord");d.innerHTML=h.innerHTML}}else this.applyCssClassToCell(f.childNodes[e+a],this.CSSCellTemporaryDeleted);this.markRecordAsDeleted(b)};oboutGrid.prototype.undeleteTemporaryRecord=function(a){if(typeof a=="object")a=this.getRecordIndexByObject(a);if(a==-1)return;for(var c=this.getBodyRow(a),d=0,f=this.isTemporaryEditedRecord(a),b=0;b<this.ColumnsCollection.length;b++)if(this.ColumnsCollection[b].AllowDelete==true){var e=this.getBodyCellInnerContainer(c.childNodes[d+b]);this.clearChildren(e);while(this.TemporaryDeletedRecords[a].childNodes.length>0)e.appendChild(this.TemporaryDeletedRecords[a].firstChild)}else{this.applyCssClassToCell(c.childNodes[d+b],this.CSSCellTemporaryDeleted,true);f&&this.applyCssClassToCell(c.childNodes[d+b],this.CSSCellTemporaryEdited)}c.style.textDecorationLineThrough=false;this.TemporaryDeletedRecords[a]=null;this.unmarkRecordAsDeleted(a);this.attemptToHideSaveCancelButtons()};oboutGrid.prototype.getRecordAsObject=function(){for(var b={},a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!="")b[this.ColumnsCollection[a].DataField]=null;return b};oboutGrid.prototype.getRecordValuesAsObject=function(d,i,j){var c={},h=this.getBodyRow(d);if(h!=null)for(var a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].DataField!="")if(i==false||this.ColumnsCollection[a].ReadOnly==true)if(!j){if(this.Rows[d])c[this.ColumnsCollection[a].DataField]=this.Rows[d].Cells[a].Value}else{var f=this.getBodyCellDataContainer(h.childNodes[d]),g="";if(f.firstChild)g=f.firstChild.nodeValue;c[this.ColumnsCollection[a].DataField]=g}else{var e=null,b=null;if(this.RowEditTemplateId==""){if(this.ColumnsCollection[a].ControlID&&this.ColumnsCollection[a].ControlPropertyName){e=this.ColumnsCollection[a].ControlID;b=this.ColumnsCollection[a].ControlPropertyName}}else if(this.ColumnsCollection[a].RowEditTemplateControlID&&this.ColumnsCollection[a].RowEditTemplateControlPropertyName){e=this.ColumnsCollection[a].RowEditTemplateControlID;b=this.ColumnsCollection[a].RowEditTemplateControlPropertyName}if(e&&b)c[this.ColumnsCollection[a].DataField]=this.getValueFromTemplateControl(e,b)}return c};oboutGrid.prototype.getRecordsIds=function(b){var a="";if(b==null)b=",";if(this.GridBodyContainer!=null)for(var d=this.getBodyTableBody(),e=d.childNodes.length,c=0;c<e;c++){if(a!="")a+=b;a+=d.childNodes[c].id}return a};oboutGrid.prototype.refresh=function(){this.initiateCallback("ob_"+this.ID+"RGBoR=1")};oboutGrid.prototype.exportToExcel=function(g,d,f,b,e,a,c){this.exportToFile("excel",g,d,f,b,e,a,c)};oboutGrid.prototype.exportToWord=function(g,d,f,b,e,a,c){this.exportToFile("word",g,d,f,b,e,a,c)};oboutGrid.prototype.exportToFile=function(k,g,d,f,c,e,a,b){this.OnClientExportStartFunction!=null&&this.raiseClientEvent(this.OnClientExportStartFunction);if(typeof g=="undefined")g="";if(typeof d=="undefined")d="";if(typeof f=="undefined")f="";if(typeof c=="undefined")c="";if(typeof e=="undefined")e="";if(typeof a=="undefined"||a==null)a="";if(typeof b=="undefined"||b==null)b="";var j="ob_"+this.ID+"ExportInfo="+this.urlEncode(k+this.ObjectPropertiesSeparator+g+this.ObjectPropertiesSeparator+d.toString()+this.ObjectPropertiesSeparator+f.toString()+this.ObjectPropertiesSeparator+c.toString()+this.ObjectPropertiesSeparator+e.toString()+this.ObjectPropertiesSeparator+a.toString()+this.ObjectPropertiesSeparator+b.toString()),h;if(this.ExportedFilesTargetWindow!="Current"){h=document.forms[0].target;document.forms[0].target="_blank"}this.OnClientExportFinishFunction!=null&&this.raiseClientEvent(this.OnClientExportFinishFunction);this.postbackGrid(j,true);if(this.ExportedFilesTargetWindow!="Current")document.forms[0].target=h;var i=document.getElementById("ob_"+this.ID+"ExportInfo");i.parentNode.removeChild(i)};oboutGrid.prototype.downloadExportedFile=function(a){this.OnClientExportFinishFunction!=null&&this.raiseClientEvent(this.OnClientExportFinishFunction);if(this.ExportedFilesTargetWindow=="Current")location.href=a;else window.open(a,"_blank")};oboutGrid.prototype.getClientSideModel=function(){this.Rows=[];for(var d=this.getBodyTableBody(),c=0;c<d.childNodes.length;c++)if(this.isBodyRecord(d.childNodes[c])){for(var b=[],e=d.childNodes[c],a=0;a<this.ColumnsCollection.length;a++){b[a]={};b[a].Value=this.xmlCdataDecode(this.getBodyCellDataContainer(e.childNodes[a]).innerHTML.toString());b[this.ColumnsCollection[a].DataField]={};b[this.ColumnsCollection[a].DataField].Value=b[a].Value}this.Rows[c]={};this.Rows[c].Cells=b}this.EnableVirtualScrolling&&this._executeOnCallbackScrollingEvents()};oboutGrid.prototype.print=function(){if(this.PrintHelperIframe==null){this.PrintHelperIframe=document.createElement("IFRAME");this.PrintHelperIframe.id="ob_"+this.ID+"PrintHelperIframe";this.PrintHelperIframe.name="ob_"+this.ID+"PrintHelperIframe";this.PrintHelperIframe.width=0;this.PrintHelperIframe.height=0;this.PrintHelperIframe.frameBorder=0;this.PrintHelperIframe.src="javascript:false;";document.body.appendChild(this.PrintHelperIframe)}var a=this.PrintHelperIframe.contentDocument?this.PrintHelperIframe.contentDocument:this.PrintHelperIframe.Document;try{a.open();typeof a.clear!="undefined"&&a.clear();a.write("<html><head>");a.write("<title>"+top.document.title+"</title>");for(var c=document.getElementsByTagName("link"),b=0;b<c.length;b++)a.write('<link rel="'+c[b].rel+'" type="'+c[b].type+'" href="'+c[b].href+'">');a.write("</head>");a.write("<body>");a.write(this.getOuterHTML(this.GridMainContainer));a.write("</body>");a.write("</html>");a.close();eval("ob_"+this.ID+"PrintHelperIframe.focus();");window.setTimeout("ob_"+this.ID+"PrintHelperIframe.print()",100)}catch(d){alert(d.Message)}};oboutGrid.prototype.raiseClientEvent=function(a,b,c,d,e){return!this.ExposeSenderForClientEvents?a(b,c,d,e):a(this,b,c,d,e)};oboutGrid.prototype.getNumberOfVisibleColumns=function(b){if(!b)b=0;for(var c=0,d=this.getIndexOfHelperColumnsForFixedColumns(),a=b;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Visible&&a!=d)c++;return c};oboutGrid.prototype.getIndexOfHelperColumnsForFixedColumns=function(){return this.NumberOfFixedColumns==0?-1:this.FixedColumnsPosition==1?this.ColumnsCollection.length-1:0};oboutGrid.prototype.getVisibleColumnsWidth=function(d){for(var b=0,c=this.getIndexOfHelperColumnsForFixedColumns(),a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Visible&&(d||a!=c))b+=this.ColumnsCollection[a].Width;return b};oboutGrid.prototype.ensureVerticalScrollingInSynch=function(){typeof this.keepVerticalScrollingInSynch=="function"&&this.keepVerticalScrollingInSynch()};oboutGrid.prototype.reorderColumn=function(c,b){var l=this.getHeaderRow();this.reorderElementChildren(l,c,b);var j=this.getBodyTableHead().firstChild;this.reorderElementChildren(j,c,b);for(var d=this.getBodyTableBody(),a=0;a<d.childNodes.length;a++){var e=d.childNodes[a];this.isBodyRecordWithDataCells(e)&&this.reorderElementChildren(e,c,b)}if(this.AllowFiltering){var k=this.getFilterRow();this.reorderElementChildren(k,c,b)}if(this.ShowColumnsFooter){var h=this.getColumnsFooterTable().firstChild.firstChild;this.reorderElementChildren(h,c,b)}var i=this.ColumnsCollection[c];if(this.RecordInEditModePreviousValues)var f=this.RecordInEditModePreviousValues[c];if(this.ArrEditRowTempValues)var g=this.ArrEditRowTempValues[c];if(c>b)for(var a=c;a>b;a--){this.ColumnsCollection[a]=this.ColumnsCollection[a-1];this.ColumnsCollection[a].Index++;if(this.RecordInEditModePreviousValues)this.RecordInEditModePreviousValues[a]=this.RecordInEditModePreviousValues[a-1];if(this.ArrEditRowTempValues)this.ArrEditRowTempValues[a]=this.ArrEditRowTempValues[a-1]}else for(var a=c;a<b;a++){this.ColumnsCollection[a]=this.ColumnsCollection[a+1];this.ColumnsCollection[a].Index--;if(this.RecordInEditModePreviousValues)this.RecordInEditModePreviousValues[a]=this.RecordInEditModePreviousValues[a+1];if(this.ArrEditRowTempValues)this.ArrEditRowTempValues[a]=this.ArrEditRowTempValues[a+1]}this.ColumnsCollection[b]=i;this.ColumnsCollection[b].Index=b;if(this.RecordInEditModePreviousValues)this.RecordInEditModePreviousValues[b]=f;if(this.ArrEditRowTempValues)this.ArrEditRowTempValues[b]=g;this.recalculateCellSeparatorsPosition();this.saveColumnsWidth();this.serializeColumns();this.getClientSideModel()};oboutGrid.prototype.reorderElementChildren=function(a,c,b){if(c>b)a.insertBefore(a.childNodes[c],a.childNodes[b]);else if(b<a.childNodes.length-1)a.insertBefore(a.childNodes[c],a.childNodes[b].nextSibling);else a.appendChild(a.childNodes[c]);this.generateFirstLastColumnClasses(a)};oboutGrid.prototype.generateFirstLastColumnClasses=function(b){for(var c=this.getFirstVisibleColumnIndex(),d=this.getLastVisibleColumnIndex(),a=0;a<this.ColumnsCollection.length;a++)if(this.ColumnsCollection[a].Visible)if(a==c){if(b.childNodes[a].className.indexOf("ob_gC_Fc")==-1)b.childNodes[a].className+=" ob_gC_Fc"}else if(a==d){if(b.childNodes[a].className.indexOf("ob_gC_Lc")==-1)b.childNodes[a].className+=" ob_gC_Lc"}else b.childNodes[a].className=b.childNodes[a].className.replace(" ob_gC_Fc","").replace(" ob_gC_Lc","")};oboutGrid.prototype.updateColumnsAfterCallback=function(b){for(var c=eval("["+b+"]"),a=0;a<this.ColumnsCollection.length;a++)this.ColumnsCollection[a].EditTemplateId=c[a].EditTemplateId};oboutGrid.prototype.saveColumnsWidth=function(){for(var b=[],a=0;a<this.ColumnsCollection.length;a++){var c=this.ColumnsCollection[a].Width;if(this.ColumnsCollection[a].WidthUnit=="%")c+="%";b.push(c)}this.ColumnsWidthContainer.value=b.join(",")};OboutGridColumn=function(K,N,z,U,R,D,c,T,S,E,V,L,F,P,I,B,G,J,C,q,H,w,u,A,O,y,x,Q,t,n,k,l,f,e,h,g,i,d,b,a,m,o,p,j,s,M,r,v){this.ColumnType=K;this.DataField=N;this.TempDataField=z;this.Visible=R;this.RealVisible=D;this.Wrap=T;this.Align=S;this.HeaderAlign=E;this.Type=V;this.MaxLength=L;this.AllowNulls=F;this.ReadOnly=P;this.AllowEdit=I;this.AllowDelete=B;this.HeaderText=G;this.ParseHTML=J;this.AllowFilter=C;this.ShowFilterCriterias=q;this.TemplateId=H;this.EditTemplateId=w;this.ControlID=M;this.ControlPropertyName=r;this.UseDoubleQuotes=v;this.Width=parseInt(c);this.RealWidth=this.Width;this.WidthUnit=c.indexOf("%")==-1?"px":"%";this.FilterControlID=u;this.AllowSorting=A;this.SortOrder=O;this.SortPriority=y;this.AllowGroupBy=x;this.GroupBy=Q;this.GroupByPriority=t;this.Index=U;if(!this.Wrap){this.CssClass="ob_gC";this.CssClassHidden="ob_gC_I"}else{this.CssClass="ob_gCW";this.CssClassHidden="ob_gCW_I"}this.WidhtHasChangedDuringBodyViewStateTracking=false;this.VisibilityHasChangedDuringBodyViewStateTracking=false;this.RowEditTemplateControlID=n;this.RowEditTemplateControlPropertyName=k;this.RowEditTemplateUseQuotes=l;this.ModifyTemporaryEditedRecord_TemplateId=f;this.CancelTemporaryEditedRecord_TemplateId=e;this.ModifyTemporaryAddedRecord_TemplateId=h;this.CancelTemporaryAddedRecord_TemplateId=g;this.RemoveTemporaryAddedRecord_TemplateId=i;this.UndeleteTemporaryDeletedRecord_TemplateId=d;this.FilterOptionsTemplates=o;this.DefaultFilterOptionID=p;this.FilterOptionsDefaultTemplateContainer=null;this.CurrentFilterOptionTemplateContainer=null;this.HasCustomFilterOptionsWithTemplates=j;this.CurrentFilterValues=null;if(b&&this.ShowFilterCriterias)this.FilterOptionsDDL=eval(b);if(a){if(oboutUtils.getById(a)==null)this.FilterControl=eval(a);else this.FilterControl=oboutUtils.getById(a);this.FilterControlPropertyName=m}this.ShowHeaderCheckBox=s};oboutGridFilterOptions=function(a){this.NoFilter=true;this.Contains=true;this.DoesNotContain=true;this.StartsWith=true;this.EndsWith=true;this.EqualTo=true;this.NotEqualTo=true;this.SmallerThan=true;this.GreaterThan=true;this.SmallerThanOrEqualTo=true;this.GreaterThanOrEqualTo=true;this.IsNull=true;this.IsNotNull=true;this.IsEmpty=true;this.IsNotEmpty=true;this.ArrOptions=["","","","","","","","","","","",""];a!=""&&this.setFilterOptions(a)};oboutGridFilterOptions.prototype.setFilterOptions=function(a){var b=a.split(",")};oboutGrid.prototype.serializeColumns=function(){for(var d="",c=[],a=0;a<this.ColumnsCollection.length;a++){var b=[];b.push(this.ColumnsCollection[a].DataField);b.push(this.ColumnsCollection[a].SortOrder);b.push(this.ColumnsCollection[a].SortPriority);b.push(this.ColumnsCollection[a].GroupBy);b.push(this.ColumnsCollection[a].GroupByPriority);b.push(this.ColumnsCollection[a].RealVisible);b.push(this.ColumnsCollection[a].Index);b.push(this.ColumnsCollection[a].TempDataField);c.push(b.join(this.ObjectPropertiesSeparator))}d=c.join(this.ArrayElementsSeparator);this.SerializedColumnsContainer.value=d};OboutGridSelectedRecord=function(b,a,c){this.Record=b;this.PreviousClassName=a;this.IsNew=c};oboutGrid.prototype.standardizeEvent=function(a){if(!a)var a=window.event;if(!a.target)a.target=a.srcElement;return a};oboutGrid.prototype.createHandlerFunction=function(c,d){var b=this,a={};a.myObj=c;a.calledFunc=d;a.myFunc=function(c){var c=b.standardizeEvent(c);return a.calledFunc.call(a.myObj,c)};return a.myFunc};oboutGrid.prototype.addEvent=function(a,b,c,d){if(a.addEventListener){a.addEventListener(b,this.createHandlerFunction(a,c),d);return true}else if(a.attachEvent)return a.attachEvent("on"+b,this.createHandlerFunction(a,c));else alert("Handler could not be attached")};oboutGrid.prototype.dFcn=function(){};var oboutGridJSLoaded=true;try{if(Sys)Sys.Application&&Sys.Application.notifyScriptLoaded()}catch(ex){};